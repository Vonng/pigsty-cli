(this["webpackJsonppigsty-config"]=this["webpackJsonppigsty-config"]||[]).push([[6],{196:function(e,t,n){},197:function(e,t,n){},201:function(e,t,n){},206:function(e,t,n){},210:function(e,t,n){var a={"./apl/apl.js":[261,30],"./asciiarmor/asciiarmor.js":[262,31],"./asn.1/asn.1.js":[263,32],"./asterisk/asterisk.js":[264,33],"./brainfuck/brainfuck.js":[265,34],"./clike/clike.js":[250,2],"./clojure/clojure.js":[266,35],"./cmake/cmake.js":[267,36],"./cobol/cobol.js":[268,37],"./coffeescript/coffeescript.js":[251,38],"./commonlisp/commonlisp.js":[269,39],"./crystal/crystal.js":[270,40],"./css/css.js":[247,1],"./cypher/cypher.js":[271,41],"./d/d.js":[272,42],"./dart/dart.js":[273,2,43],"./diff/diff.js":[274,44],"./django/django.js":[275,0,1,11],"./dockerfile/dockerfile.js":[276,21],"./dtd/dtd.js":[277,45],"./dylan/dylan.js":[278,46],"./ebnf/ebnf.js":[279,47],"./ecl/ecl.js":[280,48],"./eiffel/eiffel.js":[281,49],"./elm/elm.js":[282,50],"./erlang/erlang.js":[283,51],"./factor/factor.js":[284,22],"./fcl/fcl.js":[285,52],"./forth/forth.js":[286,53],"./fortran/fortran.js":[287,54],"./gas/gas.js":[288,55],"./gfm/gfm.js":[289,4,20],"./gherkin/gherkin.js":[290,56],"./go/go.js":[291,57],"./groovy/groovy.js":[292,58],"./haml/haml.js":[293,0,1,14],"./handlebars/handlebars.js":[252,16],"./haskell-literate/haskell-literate.js":[294,26],"./haskell/haskell.js":[253,59],"./haxe/haxe.js":[295,60],"./htmlembedded/htmlembedded.js":[296,0,1,10],"./htmlmixed/htmlmixed.js":[246,0,1,27],"./http/http.js":[297,61],"./idl/idl.js":[298,62],"./javascript/javascript.js":[248,0],"./jinja2/jinja2.js":[299,63],"./jsx/jsx.js":[300,0,28],"./julia/julia.js":[301,64],"./livescript/livescript.js":[302,65],"./lua/lua.js":[303,66],"./markdown/markdown.js":[258,4],"./mathematica/mathematica.js":[304,67],"./mbox/mbox.js":[305,68],"./meta.js":[154],"./mirc/mirc.js":[306,69],"./mllike/mllike.js":[307,70],"./modelica/modelica.js":[308,71],"./mscgen/mscgen.js":[309,72],"./mumps/mumps.js":[310,73],"./nginx/nginx.js":[311,74],"./nsis/nsis.js":[312,23],"./ntriples/ntriples.js":[313,75],"./octave/octave.js":[314,76],"./oz/oz.js":[315,77],"./pascal/pascal.js":[316,78],"./pegjs/pegjs.js":[317,0,79],"./perl/perl.js":[318,80],"./php/php.js":[319,0,1,2,17],"./pig/pig.js":[320,81],"./powershell/powershell.js":[321,82],"./properties/properties.js":[322,83],"./protobuf/protobuf.js":[323,84],"./pug/pug.js":[259,0,1,3],"./puppet/puppet.js":[324,85],"./python/python.js":[254,86],"./q/q.js":[325,87],"./r/r.js":[326,88],"./rpm/rpm.js":[327,89],"./rst/rst.js":[328,13],"./ruby/ruby.js":[249,90],"./rust/rust.js":[329,24],"./sas/sas.js":[330,91],"./sass/sass.js":[256,1,92],"./scheme/scheme.js":[331,93],"./shell/shell.js":[332,94],"./sieve/sieve.js":[333,95],"./slim/slim.js":[334,0,1,15],"./smalltalk/smalltalk.js":[335,96],"./smarty/smarty.js":[336,97],"./solr/solr.js":[337,98],"./soy/soy.js":[338,0,1,18],"./sparql/sparql.js":[339,99],"./spreadsheet/spreadsheet.js":[340,100],"./sql/sql.js":[341,101],"./stex/stex.js":[255,102],"./stylus/stylus.js":[260,5],"./swift/swift.js":[342,103],"./tcl/tcl.js":[343,104],"./textile/textile.js":[344,105],"./tiddlywiki/tiddlywiki.js":[345,106],"./tiki/tiki.js":[346,107],"./toml/toml.js":[347,108],"./tornado/tornado.js":[348,0,1,12],"./troff/troff.js":[349,109],"./ttcn-cfg/ttcn-cfg.js":[351,110],"./ttcn/ttcn.js":[350,111],"./turtle/turtle.js":[352,112],"./twig/twig.js":[353,19],"./vb/vb.js":[354,113],"./vbscript/vbscript.js":[355,114],"./velocity/velocity.js":[356,115],"./verilog/verilog.js":[357,116],"./vhdl/vhdl.js":[358,117],"./vue/vue.js":[359,0,1,5,3,9],"./wast/wast.js":[360,25],"./webidl/webidl.js":[361,118],"./xml/xml.js":[245,119],"./xquery/xquery.js":[362,120],"./yacas/yacas.js":[363,121],"./yaml-frontmatter/yaml-frontmatter.js":[364,29],"./yaml/yaml.js":[257,122],"./z80/z80.js":[365,123]};function s(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],s=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n.t(s,7)}))}s.keys=function(){return Object.keys(a)},s.id=210,e.exports=s},212:function(e,t,n){},237:function(e,t,n){},238:function(e,t,n){},243:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),r=n(53),c=n.n(r),i=(n(196),n(197),n(39)),o=n(19),l=n(10),u=n(11),j=n(13),d=n(12),h=n(14),b=n(377),m=n(180),p=n(54),f=(n(201),n(2)),O=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={activeItem:""},a}return Object(u.a)(n,[{key:"_jumpHome",value:function(){this.props.history.push("/")}},{key:"handleItemClick",value:function(e,t){var n=this.props.history;console.log(t),this.setState({activeItem:t.name}),n.push("/"+t.name)}},{key:"render",value:function(){var e=this.props.location,t=this.state.activeItem;return Object(f.jsx)(b.a,{children:Object(f.jsxs)("div",{className:"top-header",children:[Object(f.jsxs)("a",{onClick:this._jumpHome.bind(this),className:"sidemenu__logo",children:[Object(f.jsx)("div",{className:"icon-menu",children:Object(f.jsx)("img",{src:"/img/pigsty/logo-white.svg",alt:"pigsty"})}),Object(f.jsx)("img",{className:"menu-img",src:"/img/pigsty/menulogo.svg",alt:"pigsty"})]}),Object(f.jsxs)(m.a,{secondary:!0,className:"top-header-menu",children:[Object(f.jsxs)(m.a.Item,{name:"",active:"/"===e.pathname,onClick:this.handleItemClick.bind(this),children:[Object(f.jsx)(p.a,{name:"sitemap"}),"Cluster"]}),Object(f.jsxs)(m.a.Item,{name:"config",active:"/config"===e.pathname,onClick:this.handleItemClick.bind(this),children:[Object(f.jsx)(p.a,{name:"settings"}),"Config"]}),Object(f.jsxs)(m.a.Item,{name:"playbook",active:"/playbook"===e.pathname,onClick:this.handleItemClick.bind(this),children:[Object(f.jsx)(p.a,{name:"paper plane outline"}),"Playbook"]}),Object(f.jsx)(m.a.Menu,{position:"right",children:Object(f.jsx)(m.a.Item,{name:"Sign Out",active:"logout"===t,onClick:this.handleItemClick.bind(this)})})]})]})})}}]),n}(s.a.Component),v=Object(o.f)(Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(O));n(206);var x=function(){return Object(f.jsx)("div",{className:"footer",children:Object(f.jsx)("div",{className:"copyright",children:"\xa9 2021 pigsty"})})},g=n(378),y=n(153),C=n(128),_=(n(157),n(158),n(147),n(159),n(160),n(212),n(97)),k=n.n(_),S=n(98),N=n.n(S),w=new(n(177).EventEmitter),E=n(18),U=n(178),D=n.n(U),P="",T={GET_CONFIG_DATA_SUCCESS:"GET_CONFIG_DATA_SUCCESS",SAVE_CONFIG_DATA_SUCCESS:"SAVE_CONFIG_DATA_SUCCESS",SAVE_LOCAL_CONFIG_DATA_SUCCESS:"SAVE_LOCAL_CONFIG_DATA_SUCCESS",ADD_NEW_CLUSTER_SUCCESS:"ADD_NEW_CLUSTER_SUCCESS",REMOVE_CLUSTER_SUCCESS:"REMOVE_CLUSTER_SUCCESS",ADD_NEW_CLUSTER_HOST_SUCCESS:"ADD_NEW_CLUSTER_HOST_SUCCESS",REMOVE_CLUSTER_HOST_SUCCESS:"REMOVE_CLUSTER_HOST_SUCCESS",ADD_NEW_CLUSTER_PG_USER_SUCCESS:"ADD_NEW_CLUSTER_PG_USER_SUCCESS",REMOVE_CLUSTER_PG_USER_SUCCESS:"REMOVE_CLUSTER_PG_USER_SUCCESS"};N.a.interceptors.request.use((function(e){return e.timeout=1e4,e.headers={"content-type":"application/x-www-form-urlencoded"},e}),(function(e){return w.emit("showToasts",{type:"error",msg:e}),Promise.reject(e)})),N.a.interceptors.response.use((function(e){return!1===e.data.success&&w.emit("showToasts",{type:"error",msg:e.data}),e}),(function(e){return"Network Error"===e.message||-1!==e.message.indexOf("timeout")?w.emit("showToasts",{type:"error",msg:e.message}):w.emit("showToasts",{type:"error",msg:e.response.data.errorInfo}),Promise.reject(e)}));var R={getConfigData:function(e,t){return function(n){N()({method:"get",url:P+"/api/v1/config",data:D.a.stringify(Object(E.a)({},e))}).then((function(a){var s;(s="object"==typeof a.data?a.data:k.a.parse(a.data)).hasOwnProperty("all")?(n(Object(E.a)({type:T.GET_CONFIG_DATA_SUCCESS,storeName:"configData",data:s},e)),"function"===typeof t&&t({success:!0,data:s})):"function"===typeof t&&t({success:!1,error:a.data})})).catch((function(e){}))}},saveConfigData:function(e,t){return function(n){N()({method:"post",url:P+"/api/v1/config",data:e}).then((function(e){console.log(e),"ok"==e.message&&"function"===typeof t&&t({success:!0,data:e})})).catch((function(e){}))}},saveLocalConfigData:function(e,t){return function(n){n(Object(E.a)({type:T.SAVE_LOCAL_CONFIG_DATA_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},addNewCluster:function(e,t){return function(n){n(Object(E.a)({type:T.ADD_NEW_CLUSTER_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},removeCluster:function(e,t){return function(n){n(Object(E.a)({type:T.REMOVE_CLUSTER_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},addNewClusterHost:function(e,t){return function(n){n(Object(E.a)({type:T.ADD_NEW_CLUSTER_HOST_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},removeClusterHost:function(e,t){return function(n){n(Object(E.a)({type:T.REMOVE_CLUSTER_HOST_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},addNewClusterPgUser:function(e,t){return function(n){n(Object(E.a)({type:T.ADD_NEW_CLUSTER_PG_USER_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},removeClusterPgUser:function(e,t){return function(n){n(Object(E.a)({type:T.REMOVE_CLUSTER_PG_USER_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}}},H=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).codeM=null,a}return Object(u.a)(n,[{key:"_goToPlaybook",value:function(){this.props.history.push("/playbook")}},{key:"_saveYaml",value:function(){var e=this.props,t=e.saveLocalConfigData,n=e.saveConfigData,a=null;try{a=k.a.parse(this.codeM.editor.getValue())}catch(s){console.log(s),w.emit("showToasts",{type:"error",msg:s.toString()})}a&&t({data:a},(function(e){e.success&&n(k.a.stringify(a),(function(e){console.log(e)}))}))}},{key:"render",value:function(){var e=this.props.configData,t=this,n=k.a.stringify(e);return Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{className:"codeViewer",children:Object(f.jsx)(C.a,{ref:function(e){(null===e||void 0===e?void 0:e.editor)&&(t.codeM=e)},value:n,options:{theme:"monokai",tabSize:2,keyMap:"sublime",mode:"yaml"}})}),Object(f.jsx)(g.a,{}),Object(f.jsxs)("div",{children:[Object(f.jsx)(y.a,{primary:!0,onClick:this._saveYaml.bind(this),children:"Save YAML"}),Object(f.jsxs)(y.a,{onClick:this._goToPlaybook.bind(this),children:[Object(f.jsx)(p.a,{name:"paper plane outline"}),"Go to Playbook"]})]})]})}}]),n}(s.a.Component),A=Object(o.f)(Object(h.b)((function(e,t){return{configData:e.configData}}),(function(e){return{saveLocalConfigData:function(t,n){return e(R.saveLocalConfigData(t,n))},saveConfigData:function(t,n){return e(R.saveConfigData(t,n))}}}))(H)),L=n(140),I=(n(236),n(237),function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).cmdUrl="",a.state={open:!1,renderCode:"Loading...",clusterName:"",sseUrl:""},a.line=0,a.codeMirrorRef=null,a.streamSSE=null,a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=w.addListener("showCmdViewer",(function(t){e.setState({open:!0,renderCode:"Loading...",sseUrl:t.sseUrl,clusterName:t.clusterName},(function(){e._openSSE()}))}))}},{key:"closeModal",value:function(){this.setState({open:!1})}},{key:"_openSSE",value:function(){var e,t=this.state,n=t.clusterName,a=t.sseUrl,s=this;this.streamSSE&&this.streamSSE.close(),this.streamSSE=new EventSource(a),null===(e=this.streamSSE)||void 0===e||e.addEventListener(n,(function(e){s.setState({renderCode:s.state.renderCode+e.data})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.renderCode,a=t.open;return Object(f.jsxs)(L.a,{closeIcon:!0,open:a,centered:!1,className:"modal-cmdviewer",onClose:this.closeModal.bind(this),children:[Object(f.jsx)(L.a.Header,{children:"Console Logs"}),Object(f.jsx)(L.a.Content,{scrolling:!0,children:Object(f.jsx)("div",{className:"cmdViewer",children:Object(f.jsx)(C.a,{ref:function(t){e.codeMirrorRef=t},value:n,options:{theme:"monokai",tabSize:2,keyMap:"sublime",mode:"shell",readOnly:"nocursor",lineNumbers:!1,autofocus:!1}})})}),Object(f.jsx)(L.a.Actions,{children:Object(f.jsx)(y.a,{primary:!0,onClick:this.closeModal.bind(this),children:"Close"})})]})}}]),n}(s.a.Component)),F=Object(o.f)(Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(I)),q=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props;e.account,e.location;return Object(f.jsx)("div",{children:Object(f.jsx)(y.a,{primary:!0,children:"LoginPage"})})}}]),n}(s.a.Component),M=Object(h.b)((function(e,t){return{account:e.account}}),(function(e){return{}}))(q),V=n(384),G=n(383),z=n(106),B=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={},a}return Object(u.a)(n,[{key:"_removeClusterHost",value:function(){var e=this.props,t=e.removeClusterHost,n=e.clusterName,a=e.hostName;w.emit("showConfirmBox",{content:"It will remove this cluster host !",callback:function(e){console.log(e),e&&t({clusterName:n,hostName:a},(function(e){}))}})}},{key:"render",value:function(){var e=this.props,t=e.hostData,n=e.hostName,a=[];return t&&(a=Object.keys(t).map((function(e,n){return Object(f.jsxs)(z.a,{children:[e,":",Object(f.jsx)(z.a.Detail,{children:t[e].toString()})]},"k-"+n)}))),Object(f.jsxs)(G.a.Item,{className:"mb-1rem",children:[Object(f.jsx)(y.a,{size:"mini",icon:"trash",basic:!0,className:"right floated no-shadow",onClick:this._removeClusterHost.bind(this)}),Object(f.jsx)(p.a,{name:"hdd outline",className:"left floated",fitted:!0,size:"large"}),Object(f.jsxs)(G.a.Content,{children:[Object(f.jsx)(G.a.Header,{as:"a",children:n}),Object(f.jsx)(G.a.Description,{className:"mt-5px",children:a})]})]})}}]),n}(s.a.Component),W=Object(o.f)(Object(h.b)((function(e,t){return{}}),(function(e){return{removeClusterHost:function(t,n){return e(R.removeClusterHost(t,n))}}}))(B)),J=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.desc,a=e.buttonText,s=e.buttomCallback;return Object(f.jsxs)("div",{className:"empty",children:[Object(f.jsx)("p",{className:"empty-title h5",children:t||"nothing"}),n?Object(f.jsx)("p",{className:"empty-subtitle font-lighter",children:n}):null,"function"==typeof s?Object(f.jsx)("div",{className:"empty-action",children:Object(f.jsx)("button",{className:"btn btn-lg btn-block btn-success",children:a||"refresh"})}):null]})}}]),n}(s.a.Component),Y=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={},a}return Object(u.a)(n,[{key:"_renderHosts",value:function(){var e=this.props,t=e.clusterData,n=e.clusterName,a=[];return(null===t||void 0===t?void 0:t.hosts)&&(a=Object.keys(null===t||void 0===t?void 0:t.hosts).map((function(e,a){return Object(f.jsx)(W,{clusterName:n,hostName:e,hostData:t.hosts[e]},"key-"+a)}))),0===a.length?Object(f.jsx)(J,{title:"no hosts"}):a}},{key:"_addNewClusterHost",value:function(){var e=this.props.clusterName;w.emit("showEditClusterHostForm",{editType:"add",clusterName:e,callback:function(e){console.log(e)}})}},{key:"_manageClusterPgUser",value:function(){var e=this.props,t=e.clusterName,n=e.clusterData;w.emit("showEditClusterPgUserForm",{clusterName:t,clusterData:n,callback:function(e){console.log(e)}})}},{key:"_runScript",value:function(){var e=this.props,t=(e.clusterData,e.clusterName);w.emit("showConfirmBox",{content:"Are you sure run this script ?",confirmButton:"Run",callback:function(e){e&&w.emit("showCmdViewer",{sseUrl:P+"/api/v1/pgsql/"+t+"/init",clusterName:t})}})}},{key:"_removeCluster",value:function(){var e=this.props,t=(e.removeCluster,e.clusterData,e.clusterName);w.emit("showConfirmBox",{content:"It will remove this cluster !",callback:function(e){e&&w.emit("showCmdViewer",{sseUrl:P+"/api/v1/pgsql/"+t+"/remove",clusterName:t})}})}},{key:"render",value:function(){var e,t=this.props,n=t.clusterData,a=t.clusterName,s=0;n.hasOwnProperty("hosts")&&(s=Object.keys(n.hosts).length);var r,c=0;(null===n||void 0===n||null===(e=n.vars)||void 0===e?void 0:e.pg_users)&&(c=null===n||void 0===n||null===(r=n.vars)||void 0===r?void 0:r.pg_users.length);return Object(f.jsxs)(V.a,{fluid:!0,children:[Object(f.jsxs)(V.a.Content,{children:[Object(f.jsx)(p.a,{name:"server",className:"left floated mr-1rem",size:"large"}),Object(f.jsxs)("div",{className:"right floated",children:[Object(f.jsxs)(y.a,{size:"mini",onClick:this._addNewClusterHost.bind(this),children:[Object(f.jsx)(p.a,{name:"plus"}),"Add Host"]}),Object(f.jsxs)(y.a,{size:"mini",onClick:this._manageClusterPgUser.bind(this),children:[Object(f.jsx)(p.a,{name:"setting"}),"Pg Users"]})]}),Object(f.jsx)(V.a.Header,{children:a}),Object(f.jsxs)(V.a.Meta,{children:[s," Hosts | ",c," PgUsers"]}),Object(f.jsx)(G.a,{children:this._renderHosts()})]}),Object(f.jsx)(V.a.Content,{extra:!0,children:Object(f.jsxs)("div",{className:"flex-row-right",children:[Object(f.jsx)(y.a,{color:n.edit?"orange":"grey",onClick:this._runScript.bind(this),children:"Run Script"}),Object(f.jsx)(y.a,{icon:"trash",onClick:this._removeCluster.bind(this)})]})})]})}}]),n}(s.a.Component),K=Object(o.f)(Object(h.b)((function(e,t){return{}}),(function(e){return{addNewClusterHost:function(t,n){return e(R.addNewClusterHost(t,n))}}}))(Y)),Q=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"_renderClusters",value:function(){var e=this.props.configData;return Object.keys(e.all.children).map((function(t,n){var a=e.all.children[t];return Object(f.jsx)(K,{clusterData:a,clusterName:t},"key-"+n)}))}},{key:"_addNewCluster",value:function(){w.emit("showEditClusterForm",{editType:"add",callback:function(e){console.log(e)}})}},{key:"render",value:function(){var e=this.props;e.configData,e.location;return Object(f.jsx)(s.a.Fragment,{children:Object(f.jsxs)("div",{className:"page-wrap",children:[Object(f.jsx)("div",{className:"flex-row-right mb-1rem",children:Object(f.jsxs)(y.a,{primary:!0,onClick:this._addNewCluster.bind(this),children:[Object(f.jsx)(p.a,{name:"plus"}),"New Cluster"]})}),Object(f.jsx)("div",{children:this._renderClusters()})]})})}}]),n}(s.a.Component),X=Object(h.b)((function(e,t){return{configData:e.configData}}),(function(e){return{}}))(Q),Z=n(22),$=n(382),ee=(n(52),n(381)),te=n(379),ne=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"runScript",value:function(){w.emit("showCmdViewer",{cmdUrl:"ldlalacmdUrl"})}},{key:"render",value:function(){return Object(Z.a)(this.props),Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Infra Provision"}),Object(f.jsx)("div",{className:"lead",children:"How to pull up infrasturcture on meta node"}),Object(f.jsx)("h2",{id:"overview",children:"Overview"}),Object(f.jsxs)("p",{children:["Infrastructure initialization is done via ",Object(f.jsx)("a",{href:"https://github.com/Vonng/pigsty/blob/master/infra.yml",children:Object(f.jsx)("code",{children:"infra.yml"})}),". The script completes the installation and deployment of ",Object(f.jsx)("strong",{children:"infrastructure"})," on the ",Object(f.jsx)("strong",{children:"meta node"}),"."]}),Object(f.jsxs)("p",{children:["``infra.yml",Object(f.jsx)("code",{children:"takes the metanode (default group name"}),"meta`) as the deployment target."]}),Object(f.jsx)("div",{className:"highlight",children:Object(f.jsx)("pre",{children:Object(f.jsx)("code",{className:"language-bash","data-lang":"bash",children:". /infra.yml"})})}),Object(f.jsxs)("p",{children:["! ",Object(f.jsx)("a",{href:"/img/play/infra.svg"})]}),Object(f.jsx)("h2",{id:"caution",children:"Caution"}),Object(f.jsx)("p",{children:Object(f.jsx)("strong",{children:"\u2757\ufe0f The initialization of the meta node must be completed before the initialization of the database node can be executed properly"})}),Object(f.jsxs)("p",{children:[Object(f.jsx)("code",{children:"infra.yml"})," is fixed to work on the group named ",Object(f.jsx)("a",{href:"https://github.com/Vonng/pigsty/blob/master/pigsty.yml#L32",children:Object(f.jsx)("code",{children:"meta"})})," in the configuration file"]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:"meta nodes"})," can be reused as ",Object(f.jsx)("strong",{children:"normal nodes"}),", i.e. PostgreSQL databases can be defined and created on meta nodes as well."]}),Object(f.jsxs)("p",{children:["Pigsty recommends using the default configuration and creating a cluster of ",Object(f.jsx)("a",{href:"https://github.com/Vonng/pigsty/blob/master/pigsty.yml#L43",children:Object(f.jsx)("code",{children:"pg-meta"})})," meta-databases on the meta-nodes for hosting Pigsty advanced features."]}),Object(f.jsx)("p",{children:"A complete execution of the initialization process can take 2 to 8 minutes, depending on the machine configuration."}),Object(f.jsx)("h2",{id:"selective-execution",children:"Selective execution"}),Object(f.jsxs)("p",{children:["Users can ",Object(f.jsx)("strong",{children:"selectively execute"})," a subset of scripts through ansible\u2019s tagging mechanism."]}),Object(f.jsx)("p",{children:"For example, if you want to execute only the local source initialization part, you can do so with the following command."}),Object(f.jsx)("div",{className:"highlight",children:Object(f.jsx)("pre",{children:Object(f.jsxs)("code",{className:"language-bash","data-lang":"bash",children:[". /infra.yml --tags",Object(f.jsx)("span",{children:"="}),"repo"]})})}),Object(f.jsxs)("p",{children:["Please refer to [",Object(f.jsx)("strong",{children:"task details"}),"](#task details) for specific tags"]}),Object(f.jsx)("p",{children:"Some common subsets of tasks include."}),Object(f.jsx)("div",{className:"highlight",children:Object(f.jsx)("pre",{children:Object(f.jsxs)("code",{className:"language-bash","data-lang":"bash",children:[". /infra.yml --tags",Object(f.jsx)("span",{children:"="}),"repo -e ",Object(f.jsx)("span",{children:"repo_rebuild"}),Object(f.jsx)("span",{children:"="}),Object(f.jsx)("span",{children:"true"}),Object(f.jsx)("span",{children:"# Force a local source to be recreated"}),". /infra.yml --tags",Object(f.jsx)("span",{children:"="}),"prometheus_reload ",Object(f.jsx)("span",{children:"# Reload Prometheus configuration"}),". /infra.yml --tags",Object(f.jsx)("span",{children:"="}),"nginx_haproxy ",Object(f.jsx)("span",{children:"# Regenerate the Nginx Haproxy index page"}),". /infra.yml --tags",Object(f.jsx)("span",{children:"="}),"prometheus_targets,prometheus_reload ",Object(f.jsx)("span",{children:"# Regenerate the Prometheus static monitoring object file and apply"})]})})}),Object(f.jsx)("h2",{id:"script-description",children:"script description"}),Object(f.jsxs)("p",{children:[Object(f.jsx)("a",{href:"https://github.com/Vonng/pigsty/blob/master/infra.yml",children:Object(f.jsx)("code",{children:"infra.yml"})})," does the following stuff:"]}),Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:"Deploy and enable local sources"}),Object(f.jsx)("li",{children:"Complete metanode initialization"}),Object(f.jsxs)("li",{children:["Complete meta-node infrastructure initialization",Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:"CA infrastructure"}),Object(f.jsx)("li",{children:"DNS Nameserver"}),Object(f.jsx)("li",{children:"Nginx"}),Object(f.jsx)("li",{children:"Prometheus & Alertmanger"}),Object(f.jsx)("li",{children:"Grafana"})]})]}),Object(f.jsx)("li",{children:"Copy the Pigsty ontology to the meta node"}),Object(f.jsx)("li",{children:"Complete database initialization on the meta node (optional, users can reuse the meta node through the standard database cluster initialization process)"})]})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsx)(te.a,{action:{color:"primary",content:"Run",onClick:this.runScript},label:"./infra.yml",actionPosition:"right",placeholder:"--tags="})]})})]})}}]),n}(s.a.Component),ae=Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(ne),se=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"runScript",value:function(){w.emit("showCmdViewer",{cmdUrl:"ldlalacmdUrl"})}},{key:"render",value:function(){var e=this;return Object(Z.a)(this.props),Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Pgsql Provision"}),Object(f.jsx)("div",{className:"lead",children:"How to define and create postgres clusters?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsx)(te.a,{action:{color:"primary",content:"Run",onClick:this.runScript},label:"./pgsql.yml",actionPosition:"right",placeholder:"--tags="}),Object(f.jsx)(ee.a.Field,{children:Object(f.jsx)(ee.a.Select,{fluid:!0,label:"pg_role",options:[{key:"p",text:"primary",value:"primary"},{key:"r",text:"replica",value:"replica"},{key:"o",text:"offline",value:"offline"}],name:"pg_role",placeholder:"",value:"",onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})})]})})]})}}]),n}(s.a.Component),re=Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(se),ce=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"runScript",value:function(){w.emit("showCmdViewer",{cmdUrl:"ldlalacmdUrl"})}},{key:"render",value:function(){return Object(Z.a)(this.props),Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Sandbox Provision"}),Object(f.jsx)("div",{className:"lead",children:"How to perform one-pass bootstrap for sandbox?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsx)(te.a,{action:{color:"primary",content:"Run",onClick:this.runScript},label:"./sandbox.yml",actionPosition:"right",placeholder:"--tags="})]})})]})}}]),n}(s.a.Component),ie=Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(ce),oe=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"runScript",value:function(){w.emit("showCmdViewer",{cmdUrl:"ldlalacmdUrl"})}},{key:"render",value:function(){return Object(Z.a)(this.props),Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Remove Clusters"}),Object(f.jsx)("div",{className:"lead",children:"How to destroy postgres clusters and instances"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsx)(te.a,{action:{color:"primary",content:"Run",onClick:this.runScript},label:"./pgsql-remove.yml",actionPosition:"right",placeholder:"-l="})]})})]})}}]),n}(s.a.Component),le=Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(oe),ue=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"runScript",value:function(){w.emit("showCmdViewer",{cmdUrl:"ldlalacmdUrl"})}},{key:"render",value:function(){return Object(Z.a)(this.props),Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Monitor Only"}),Object(f.jsx)("div",{className:"lead",children:"How to deploy pigsty monitoring system without provisioning solution?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsx)(te.a,{action:{color:"primary",content:"Run",onClick:this.runScript},label:"./pgsql-monitor.yml",actionPosition:"right",placeholder:"-l"})]})})]})}}]),n}(s.a.Component),je=Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(ue),de=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"runScript",value:function(){w.emit("showCmdViewer",{cmdUrl:"ldlalacmdUrl"})}},{key:"render",value:function(){return Object(Z.a)(this.props),Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Create User"}),Object(f.jsx)("div",{className:"lead",children:"How to perform one-pass bootstrap for sandbox?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsx)(te.a,{action:{color:"primary",content:"Run",onClick:this.runScript},label:"./pgsql-createuser.yml",actionPosition:"right",placeholder:"-l"})]})})]})}}]),n}(s.a.Component),he=Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(de),be=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"runScript",value:function(){w.emit("showCmdViewer",{cmdUrl:"ldlalacmdUrl"})}},{key:"render",value:function(){return Object(Z.a)(this.props),Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Create Database"}),Object(f.jsx)("div",{className:"lead",children:"How to create new database on running clusters?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsx)(te.a,{action:{color:"primary",content:"Run",onClick:this.runScript},label:"./pgsql-createuser.yml",actionPosition:"right",placeholder:"-l"})]})})]})}}]),n}(s.a.Component),me=Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(be),pe=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"runScript",value:function(){w.emit("showCmdViewer",{cmdUrl:"ldlalacmdUrl"})}},{key:"render",value:function(){return Object(Z.a)(this.props),Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Service Provision"}),Object(f.jsx)("div",{className:"lead",children:"How to perform one-pass bootstrap for sandbox?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsx)(te.a,{action:{color:"primary",content:"Run",onClick:this.runScript},label:"./pgsql-service.yml",actionPosition:"right",placeholder:"-l"})]})})]})}}]),n}(s.a.Component),fe=Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(pe),Oe=[{menuItem:{key:"infraProvision",icon:"arrow alternate circle right outline",content:"Infra Provision"},render:function(){return Object(f.jsx)($.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(ae,{})})}},{menuItem:{key:"pgsqlProvision",icon:"arrow alternate circle right outline",content:"Pgsql Provision"},render:function(){return Object(f.jsx)($.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(re,{})})}},{menuItem:{key:"sandboxProvision",icon:"arrow alternate circle right outline",content:"Sandbox Provision"},render:function(){return Object(f.jsx)($.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(ie,{})})}},{menuItem:{key:"removeClusters",icon:"arrow alternate circle right outline",content:"Remove Clusters"},render:function(){return Object(f.jsx)($.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(le,{})})}},{menuItem:{key:"monitorOnly",icon:"arrow alternate circle right outline",content:"Monitor Only"},render:function(){return Object(f.jsx)($.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(je,{})})}},{menuItem:{key:"createUser",icon:"arrow alternate circle right outline",content:"Create User"},render:function(){return Object(f.jsx)($.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(he,{})})}},{menuItem:{key:"createDatabase",icon:"arrow alternate circle right outline",content:"Create Database"},render:function(){return Object(f.jsx)($.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(me,{})})}},{menuItem:{key:"serviceProvision",icon:"arrow alternate circle right outline",content:"Service Provision"},render:function(){return Object(f.jsx)($.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(fe,{})})}}],ve=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(Z.a)(this.props),Object(f.jsx)("div",{className:"page-wrap playbook",children:Object(f.jsx)($.a,{menu:{fluid:!0,vertical:!0,tabular:!0},panes:Oe})})}}]),n}(s.a.Component),xe=Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(ve),ge=(n(238),[{menuItem:{key:"YAML",icon:"code",content:"YAML"},render:function(){return Object(f.jsx)($.a.Pane,{children:Object(f.jsx)(A,{})})}}]),ye=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"render",value:function(){return Object(Z.a)(this.props),Object(f.jsx)("div",{className:"page-wrap pigsty-config",children:Object(f.jsx)($.a,{panes:ge})})}}]),n}(s.a.Component),Ce=Object(h.b)((function(e,t){return{}}),(function(e){return{}}))(ye),_e=n(50),ke=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={open:!1,editType:"add",clusterName:""},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=w.addListener("showEditClusterForm",(function(t){e.setState(Object(E.a)({open:!0},t))}))}},{key:"_editCluster",value:function(){var e=this,t=this.props.addNewCluster,n=this.state.clusterName;if(0===n.length||n.length>50)return w.emit("showToasts",{type:"error",msg:"cluster name length error"}),!1;t({clusterName:n},(function(t){e.setOpen(!1)}))}},{key:"setOpen",value:function(e){this.setState({open:e,clusterName:"",editType:"add"})}},{key:"_inputChange",value:function(e,t){console.log(e),this.setState(Object(_e.a)({},e,t))}},{key:"render",value:function(){var e=this,t=this.state,n=t.open,a=t.clusterName,s=t.editType;return Object(f.jsxs)(L.a,{onClose:this.setOpen.bind(this,!1),open:n,size:"mini",children:[Object(f.jsx)(L.a.Header,{children:"add"===s?"Add Cluster":"Edit Cluster"}),Object(f.jsx)(L.a.Content,{children:Object(f.jsx)(ee.a,{children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Cluster Name"}),Object(f.jsx)(ee.a.Input,{value:a,placeholder:"name",name:"clusterName",onChange:function(t,n){var a=n.name,s=n.value;e._inputChange(a,s)}})]})})}),Object(f.jsxs)(L.a.Actions,{children:[Object(f.jsx)(y.a,{basic:!0,onClick:this.setOpen.bind(this,!1),children:"Cancel"}),Object(f.jsx)(y.a,{primary:!0,onClick:this._editCluster.bind(this),children:"Save"})]})]})}}]),n}(s.a.Component),Se=Object(o.f)(Object(h.b)((function(e,t){return{}}),(function(e){return{addNewCluster:function(t,n){return e(R.addNewCluster(t,n))}}}))(ke)),Ne=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={open:!1,editType:"add",pg_offline_query:!1,host_ip:"",pg_role:"",pg_seq:"",clusterName:null},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=w.addListener("showEditClusterHostForm",(function(t){e.setState(Object(E.a)({open:!0},t))}))}},{key:"setOpen",value:function(e){this.setState({open:e})}},{key:"_inputHandle",value:function(e,t){this.setState(Object(_e.a)({},e,t))}},{key:"_editClusterHost",value:function(){var e=this,t=this.props.addNewClusterHost,n=this.state,a=n.pg_offline_query,s=n.host_ip,r=n.pg_role,c=n.pg_seq,i=n.clusterName;i&&t({pg_offline_query:a,host_ip:s,pg_role:r,pg_seq:c,clusterName:i},(function(t){e.setOpen(!1)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.open,a=t.pg_offline_query,s=t.host_ip,r=t.pg_role,c=t.pg_seq,i=t.editType;this.props.configData;return Object(f.jsxs)(L.a,{onClose:this.setOpen.bind(this,!1),open:n,size:"mini",children:[Object(f.jsx)(L.a.Header,{children:"add"===i?"Add Cluster Host":"Edit Cluster Host"}),Object(f.jsx)(L.a.Content,{children:Object(f.jsxs)(ee.a,{children:[Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"host_ip"}),Object(f.jsx)(te.a,{placeholder:"0.0.0.0",name:"host_ip",value:s,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"pg_seq"}),Object(f.jsx)(te.a,{placeholder:"0",name:"pg_seq",value:c,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,parseInt(s))}})]}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)("label",{children:"pg_offline_query"}),Object(f.jsx)(ee.a.Radio,{label:"true",name:"pg_offline_query",checked:!0===a,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"pg_offline_query",checked:!1===a,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}),Object(f.jsx)(ee.a.Field,{children:Object(f.jsx)(ee.a.Select,{fluid:!0,label:"pg_role",options:[{key:"p",text:"primary",value:"primary"},{key:"r",text:"replica",value:"replica"},{key:"o",text:"offline",value:"offline"}],name:"pg_role",placeholder:"",value:r,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})})]})}),Object(f.jsxs)(L.a.Actions,{children:[Object(f.jsx)(y.a,{basic:!0,onClick:this.setOpen.bind(this,!1),children:"Cancel"}),Object(f.jsx)(y.a,{primary:!0,onClick:this._editClusterHost.bind(this),children:"Save"})]})]})}}]),n}(s.a.Component),we=Object(o.f)(Object(h.b)((function(e,t){return{configData:e.configData}}),(function(e){return{addNewClusterHost:function(t,n){return e(R.addNewClusterHost(t,n))}}}))(Ne)),Ee=n(129),Ue=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={open:!1,editType:"add",name:"",password:"",roles:["dbrole_offline"],expire_in:365,pgbouncer:!1,comment:"",clusterData:null},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=w.addListener("showEditClusterPgUserForm",(function(t){e.setState(Object(E.a)({open:!0},t))}))}},{key:"setOpen",value:function(e){this.setState({open:e})}},{key:"_inputHandle",value:function(e,t){this.setState(Object(_e.a)({},e,t))}},{key:"_checkboxHandle",value:function(e,t,n){n?this.setState(Object(_e.a)({},e,[].concat(Object(Ee.a)(this.state[e]),[t]))):(this.state[e].splice(this.state[e].findIndex((function(e){return e===t})),1),this.setState(Object(_e.a)({},e,this.state[e])))}},{key:"_editClusterPgUser",value:function(){}},{key:"_addNewClusterPgUser",value:function(){var e=this.props.addNewClusterPgUser,t=this.state;e({name:t.name,password:t.password,roles:t.roles,expire_in:t.expire_in,pgbouncer:t.pgbouncer,comment:t.comment,clusterName:t.clusterName},(function(e){}))}},{key:"_removeClusterPgUser",value:function(e){var t=this.props.removeClusterPgUser,n=this.state.clusterName;w.emit("showConfirmBox",{content:"Are you sure ?",callback:function(a){a&&t({name:e,clusterName:n},(function(e){}))}})}},{key:"_renderPgUserInfo",value:function(e){e&&e.map((function(t,n){return Object(f.jsxs)(z.a,{children:[t,":",Object(f.jsx)(z.a.Detail,{children:e[t].toString()})]},"k-"+n)}))}},{key:"_renderPgUsers",value:function(){var e,t=this,n=this.state.clusterName,a=this.props.configData.all.children[n],s=[];return(null===a||void 0===a||null===(e=a.vars)||void 0===e?void 0:e.pg_users)&&(s=a.vars.pg_users.map((function(e,n){return Object(f.jsxs)(G.a.Item,{className:"mb-1rem",children:[Object(f.jsx)(y.a,{size:"mini",icon:"trash",basic:!0,className:"right floated no-shadow",onClick:t._removeClusterPgUser.bind(t,e.name)}),Object(f.jsx)(p.a,{name:"user",className:"left floated",fitted:!0,size:"large"}),Object(f.jsxs)(G.a.Content,{children:[Object(f.jsx)(G.a.Header,{as:"a",children:e.name}),Object(f.jsx)(G.a.Description,{className:"mt-5px",children:e.comment})]})]})}))),Object(f.jsx)(G.a,{children:s})}},{key:"render",value:function(){var e=this,t=this.state,n=t.open,a=(t.editType,t.name),s=t.password,r=t.roles,c=(t.expire_in,t.pgbouncer),i=t.comment;return Object(f.jsxs)(L.a,{onClose:this.setOpen.bind(this,!1),open:n,size:"small",children:[Object(f.jsx)(L.a.Header,{children:"Manage Cluster Pg Users"}),Object(f.jsxs)(L.a.Content,{children:[this._renderPgUsers(),Object(f.jsx)(V.a,{fluid:!0,children:Object(f.jsxs)(V.a.Content,{children:[Object(f.jsxs)(ee.a,{children:[Object(f.jsxs)(ee.a.Group,{widths:"equal",children:[Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"name"}),Object(f.jsx)(te.a,{placeholder:"",name:"name",value:a,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"password"}),Object(f.jsx)(te.a,{placeholder:"",name:"password",value:s,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]})]}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)("label",{children:"pgbouncer"}),Object(f.jsx)(ee.a.Radio,{label:"true",name:"pgbouncer",checked:!0===c,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"pgbouncer",checked:!1===c,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)("label",{children:"roles"}),Object(f.jsxs)("div",{className:"flex-row-left flex-wrap",children:[Object(f.jsx)(ee.a.Field,{children:Object(f.jsx)(ee.a.Checkbox,{label:"dbrole_readonly",name:"dbrole_readonly",checked:void 0!==r.find((function(e){return"dbrole_readonly"===e})),onChange:function(t,n){var a=n.checked;e._checkboxHandle("roles","dbrole_readonly",a)}})}),Object(f.jsx)(ee.a.Field,{children:Object(f.jsx)(ee.a.Checkbox,{label:"dbrole_offline",name:"dbrole_offline",checked:void 0!==r.find((function(e){return"dbrole_offline"===e})),onChange:function(t,n){var a=n.checked;e._checkboxHandle("roles","dbrole_offline",a)}})}),Object(f.jsx)(ee.a.Field,{children:Object(f.jsx)(ee.a.Checkbox,{label:"dbrole_readwrite",name:"dbrole_readwrite",checked:void 0!==r.find((function(e){return"dbrole_readwrite"===e})),onChange:function(t,n){var a=n.checked;e._checkboxHandle("roles","dbrole_readwrite",a)}})}),Object(f.jsx)(ee.a.Field,{children:Object(f.jsx)(ee.a.Checkbox,{label:"dbrole_admin",name:"dbrole_admin",checked:void 0!==r.find((function(e){return"dbrole_admin"===e})),onChange:function(t,n){var a=n.checked;e._checkboxHandle("roles","dbrole_admin",a)}})})]})]}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"comment"}),Object(f.jsx)(te.a,{placeholder:"example personal user for interactive queries",name:"comment",value:i,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]})]}),Object(f.jsx)(V.a.Content,{extra:!0,className:"flex-row-center mt-1rem",children:Object(f.jsx)(y.a,{primary:!0,onClick:this._addNewClusterPgUser.bind(this),children:"Add"})})]})})]}),Object(f.jsx)(L.a.Actions,{children:Object(f.jsx)(y.a,{onClick:this.setOpen.bind(this,!1),children:"Close"})})]})}}]),n}(s.a.Component),De=Object(o.f)(Object(h.b)((function(e,t){return{configData:e.configData}}),(function(e){return{addNewClusterPgUser:function(t,n){return e(R.addNewClusterPgUser(t,n))},removeClusterPgUser:function(t,n){return e(R.removeClusterPgUser(t,n))}}}))(Ue)),Pe=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsxs)("div",{className:"inner-page",children:[Object(f.jsx)(v,{}),Object(f.jsx)("div",{id:"mainWrap",children:Object(f.jsxs)("div",{id:"mainContent",children:[Object(f.jsx)(o.a,{path:"/login",component:M}),Object(f.jsx)(o.a,{path:"/",exact:!0,component:X}),Object(f.jsx)(o.a,{path:"/config",component:Ce}),Object(f.jsx)(o.a,{path:"/playbook",component:xe})]})}),Object(f.jsx)(x,{})]}),Object(f.jsx)(F,{}),Object(f.jsx)(Se,{}),Object(f.jsx)(we,{}),Object(f.jsx)(De,{})]})}}]),n}(s.a.Component),Te=n(182),Re=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={visible:!!e.visible&&e.visible,loadingText:e.loadingText?e.loadingText:""},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=w.addListener("showLoadingCover",(function(t){e.setState({visible:t,loadingText:"\u6570\u636e\u52a0\u8f7d\u4e2d..."})}))}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.visible,n=e.loadingText;return t?Object(f.jsx)("div",{id:"loadingCover",children:Object(f.jsxs)("div",{className:"loading-overlay",children:[Object(f.jsx)("div",{className:"loading loading-lg"}),Object(f.jsx)("div",{className:"font-bold",style:{marginLeft:"2rem"},children:n})]})}):null}}]),n}(s.a.Component),He=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"_getConfigData",value:function(){(0,this.props.getConfigData)({},(function(e){}))}},{key:"render",value:function(){var e=this.props,t=e.component,n=e.configData,a=Object(Te.a)(e,["component","configData"]);return n.hasOwnProperty("all")?Object(f.jsx)(o.a,Object(E.a)(Object(E.a)({},a),{},{render:function(e){return Object(f.jsx)(t,Object(E.a)({},e))}})):(this._getConfigData(),Object(f.jsx)(Re,{visible:!0,loadingText:"initializing..."}))}}]),n}(s.a.Component),Ae=Object(h.b)((function(e,t){return{configData:e.configData}}),(function(e){return{getConfigData:function(t,n){return e(R.getConfigData(t,n))}}}))(He);n(239);var Le=function(){return Object(f.jsx)(i.a,{basename:"/",children:Object(f.jsx)(o.c,{children:Object(f.jsx)(Ae,{path:"/",component:Pe})})})},Ie=function(e){e&&e instanceof Function&&n.e(124).then(n.bind(null,390)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),s(e),r(e),c(e)}))},Fe=n(70),qe=n(179),Me={};var Ve={};var Ge=Object(Fe.c)({account:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Me;return e},configData:function(){var e,t,n,a,s,r,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve,i=arguments.length>1?arguments[1]:void 0;switch(i.type){case T.GET_CONFIG_DATA_SUCCESS:case T.SAVE_LOCAL_CONFIG_DATA_SUCCESS:return i.data;case T.ADD_NEW_CLUSTER_SUCCESS:return c.all.children[i.clusterName]={edit:!0,hosts:{}},JSON.parse(JSON.stringify(c));case T.ADD_NEW_CLUSTER_HOST_SUCCESS:return c.all.children[i.clusterName].edit=!0,c.all.children[i.clusterName].hosts[i.host_ip]={pg_offline_query:i.pg_offline_query,pg_role:i.pg_role,pg_seq:i.pg_seq},JSON.parse(JSON.stringify(c));case T.REMOVE_CLUSTER_HOST_SUCCESS:return c.all.children[i.clusterName].edit=!0,delete c.all.children[i.clusterName].hosts[i.hostName],JSON.parse(JSON.stringify(c));case T.ADD_NEW_CLUSTER_PG_USER_SUCCESS:if((null===(e=c.all.children[i.clusterName])||void 0===e||null===(t=e.vars)||void 0===t?void 0:t.pg_users)||(c.all.children[i.clusterName].vars.pg_users=[]),null===(n=c.all.children[i.clusterName])||void 0===n||null===(a=n.vars)||void 0===a?void 0:a.pg_users){var o={name:i.name,password:i.password,roles:i.roles,expire_in:i.expire_in,pgbouncer:i.pgbouncer,comment:i.comment};c.all.children[i.clusterName].vars.pg_users.push(o),c.all.children[i.clusterName].edit=!0}return JSON.parse(JSON.stringify(c));case T.REMOVE_CLUSTER_PG_USER_SUCCESS:if(null===(s=c.all.children[i.clusterName])||void 0===s||null===(r=s.vars)||void 0===r?void 0:r.pg_users){var l=c.all.children[i.clusterName].vars.pg_users.findIndex((function(e){return e.name===i.name}));c.all.children[i.clusterName].vars.pg_users.splice(l,1),c.all.children[i.clusterName].edit=!0}return JSON.parse(JSON.stringify(c));default:return c}}}),ze=[function(e){return function(e){return function(t){return e(t)}}},qe.a],Be=Fe.a.apply(void 0,ze)(Fe.d)(Ge,{}),We={info:"toast-primary",success:"toast-success",warning:"toast-warning",error:"toast-error"},Je=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={toasts:[]},a}return Object(u.a)(n,[{key:"_delItem",value:function(){var e=this.state.toasts;e.shift(),this.setState({toasts:e})}},{key:"componentDidMount",value:function(){var e=this;this.emitter=w.addListener("showToasts",(function(t){e.setState({toasts:[].concat(Object(Ee.a)(e.state.toasts),[t])},(function(){setTimeout((function(){e._delItem()}),3e3)}))}))}},{key:"componentWillUnmount",value:function(){}},{key:"_renderToast",value:function(e,t){var n="toast "+We[e.type];return Object(f.jsx)("div",{className:n,children:Object(f.jsx)("div",{className:"toast-content",children:e.msg})},t)}},{key:"render",value:function(){var e=this,t=(this.props.account,this.state.toasts),n=[];return t.forEach((function(t,a){n.push(e._renderToast(t,a))})),Object(f.jsx)("div",{id:"toastsPanel",children:n})}}]),n}(s.a.Component),Ye=n(380),Ke=function(e){Object(j.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={open:!1,content:"",confirmButton:"OK",cancelButton:"Cancel"},a.parentCallback=null,a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=w.addListener("showConfirmBox",(function(t){e.setState(Object(E.a)(Object(E.a)({},t),{},{open:!0})),e.parentCallback=t.callback}))}},{key:"handleConfirm",value:function(){var e=this;this.setState({content:"Are you sure?",confirmButton:"OK",cancelButton:"Cancel",open:!1},(function(){"function"===typeof e.parentCallback&&e.parentCallback(!0)}))}},{key:"handleCancel",value:function(){var e=this;this.setState({content:"Are you sure?",confirmButton:"OK",cancelButton:"Cancel",open:!1},(function(){"function"===typeof e.parentCallback&&e.parentCallback(!1)}))}},{key:"render",value:function(){var e=this.state,t=e.open,n=e.content,a=e.confirmButton,s=e.cancelButton;return Object(f.jsx)(Ye.a,{size:"mini",open:t,content:n,confirmButton:a,cancelButton:s,onCancel:this.handleCancel.bind(this),onConfirm:this.handleConfirm.bind(this)})}}]),n}(s.a.Component);n(242);c.a.render(Object(f.jsx)(h.a,{store:Be,children:Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(Re,{}),Object(f.jsx)(Je,{}),Object(f.jsx)(Ke,{}),Object(f.jsx)(Le,{})]})}),document.getElementById("root")),Ie()},52:function(e,t,n){}},[[243,7,8]]]);
//# sourceMappingURL=main.162b1900.chunk.js.map