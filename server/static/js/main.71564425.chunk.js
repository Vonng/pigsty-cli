(this["webpackJsonppigsty-config"]=this["webpackJsonppigsty-config"]||[]).push([[6],{154:function(e,t,n){},200:function(e,t,n){},201:function(e,t,n){},205:function(e,t,n){},210:function(e,t,n){},231:function(e,t,n){},232:function(e,t,n){},236:function(e,t,n){var a={"./apl/apl.js":[263,30],"./asciiarmor/asciiarmor.js":[264,31],"./asn.1/asn.1.js":[265,32],"./asterisk/asterisk.js":[266,33],"./brainfuck/brainfuck.js":[267,34],"./clike/clike.js":[252,2],"./clojure/clojure.js":[268,35],"./cmake/cmake.js":[269,36],"./cobol/cobol.js":[270,37],"./coffeescript/coffeescript.js":[253,38],"./commonlisp/commonlisp.js":[271,39],"./crystal/crystal.js":[272,40],"./css/css.js":[249,1],"./cypher/cypher.js":[273,41],"./d/d.js":[274,42],"./dart/dart.js":[275,2,43],"./diff/diff.js":[276,44],"./django/django.js":[277,0,1,11],"./dockerfile/dockerfile.js":[278,21],"./dtd/dtd.js":[279,45],"./dylan/dylan.js":[280,46],"./ebnf/ebnf.js":[281,47],"./ecl/ecl.js":[282,48],"./eiffel/eiffel.js":[283,49],"./elm/elm.js":[284,50],"./erlang/erlang.js":[285,51],"./factor/factor.js":[286,22],"./fcl/fcl.js":[287,52],"./forth/forth.js":[288,53],"./fortran/fortran.js":[289,54],"./gas/gas.js":[290,55],"./gfm/gfm.js":[291,4,20],"./gherkin/gherkin.js":[292,56],"./go/go.js":[293,57],"./groovy/groovy.js":[294,58],"./haml/haml.js":[295,0,1,14],"./handlebars/handlebars.js":[254,16],"./haskell-literate/haskell-literate.js":[296,26],"./haskell/haskell.js":[255,59],"./haxe/haxe.js":[297,60],"./htmlembedded/htmlembedded.js":[298,0,1,10],"./htmlmixed/htmlmixed.js":[248,0,1,27],"./http/http.js":[299,61],"./idl/idl.js":[300,62],"./javascript/javascript.js":[250,0],"./jinja2/jinja2.js":[301,63],"./jsx/jsx.js":[302,0,28],"./julia/julia.js":[303,64],"./livescript/livescript.js":[304,65],"./lua/lua.js":[305,66],"./markdown/markdown.js":[260,4],"./mathematica/mathematica.js":[306,67],"./mbox/mbox.js":[307,68],"./meta.js":[161],"./mirc/mirc.js":[308,69],"./mllike/mllike.js":[309,70],"./modelica/modelica.js":[310,71],"./mscgen/mscgen.js":[311,72],"./mumps/mumps.js":[312,73],"./nginx/nginx.js":[313,74],"./nsis/nsis.js":[314,23],"./ntriples/ntriples.js":[315,75],"./octave/octave.js":[316,76],"./oz/oz.js":[317,77],"./pascal/pascal.js":[318,78],"./pegjs/pegjs.js":[319,0,79],"./perl/perl.js":[320,80],"./php/php.js":[321,0,1,2,17],"./pig/pig.js":[322,81],"./powershell/powershell.js":[323,82],"./properties/properties.js":[324,83],"./protobuf/protobuf.js":[325,84],"./pug/pug.js":[261,0,1,3],"./puppet/puppet.js":[326,85],"./python/python.js":[256,86],"./q/q.js":[327,87],"./r/r.js":[328,88],"./rpm/rpm.js":[329,89],"./rst/rst.js":[330,13],"./ruby/ruby.js":[251,90],"./rust/rust.js":[331,24],"./sas/sas.js":[332,91],"./sass/sass.js":[258,1,92],"./scheme/scheme.js":[333,93],"./shell/shell.js":[334,94],"./sieve/sieve.js":[335,95],"./slim/slim.js":[336,0,1,15],"./smalltalk/smalltalk.js":[337,96],"./smarty/smarty.js":[338,97],"./solr/solr.js":[339,98],"./soy/soy.js":[340,0,1,18],"./sparql/sparql.js":[341,99],"./spreadsheet/spreadsheet.js":[342,100],"./sql/sql.js":[343,101],"./stex/stex.js":[257,102],"./stylus/stylus.js":[262,5],"./swift/swift.js":[344,103],"./tcl/tcl.js":[345,104],"./textile/textile.js":[346,105],"./tiddlywiki/tiddlywiki.js":[347,106],"./tiki/tiki.js":[348,107],"./toml/toml.js":[349,108],"./tornado/tornado.js":[350,0,1,12],"./troff/troff.js":[351,109],"./ttcn-cfg/ttcn-cfg.js":[353,110],"./ttcn/ttcn.js":[352,111],"./turtle/turtle.js":[354,112],"./twig/twig.js":[355,19],"./vb/vb.js":[356,113],"./vbscript/vbscript.js":[357,114],"./velocity/velocity.js":[358,115],"./verilog/verilog.js":[359,116],"./vhdl/vhdl.js":[360,117],"./vue/vue.js":[361,0,1,5,3,9],"./wast/wast.js":[362,25],"./webidl/webidl.js":[363,118],"./xml/xml.js":[247,119],"./xquery/xquery.js":[364,120],"./yacas/yacas.js":[365,121],"./yaml-frontmatter/yaml-frontmatter.js":[366,29],"./yaml/yaml.js":[259,122],"./z80/z80.js":[367,123]};function s(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],s=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n.t(s,7)}))}s.keys=function(){return Object.keys(a)},s.id=236,e.exports=s},238:function(e,t,n){},240:function(e,t,n){},241:function(e,t,n){},246:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),r=n(53),c=n.n(r),i=(n(200),n(201),n(31)),l=n(18),o=n(8),u=n(9),d=n(11),j=n(10),b=n(13),h=n(383),m=n(183),p=n(54),f=(n(205),n(0)),O=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={activeItem:""},a}return Object(u.a)(n,[{key:"_jumpHome",value:function(){this.props.history.push("/")}},{key:"handleItemClick",value:function(e,t){var n=this.props.history;this.setState({activeItem:t.name}),n.push("/"+t.name)}},{key:"render",value:function(){var e=this.props.location;this.state.activeItem;return Object(f.jsx)(h.a,{children:Object(f.jsxs)("div",{className:"top-header",children:[Object(f.jsxs)("div",{onClick:this._jumpHome.bind(this),className:"sidemenu__logo",children:[Object(f.jsx)("div",{className:"icon-menu",children:Object(f.jsx)("img",{src:"/img/pigsty/logo-white.svg"})}),Object(f.jsx)("img",{className:"menu-img",src:"/img/pigsty/menulogo.svg",alt:"pigsty"})]}),Object(f.jsxs)(m.a,{secondary:!0,className:"top-header-menu",children:[Object(f.jsxs)(m.a.Item,{name:"",active:"/"===e.pathname,onClick:this.handleItemClick.bind(this),children:[Object(f.jsx)(p.a,{name:"sitemap"}),"Cluster"]}),Object(f.jsxs)(m.a.Item,{name:"config",active:"/config"===e.pathname,onClick:this.handleItemClick.bind(this),children:[Object(f.jsx)(p.a,{name:"code"}),"Config"]}),Object(f.jsxs)(m.a.Item,{name:"jobs",active:"/jobs"===e.pathname,onClick:this.handleItemClick.bind(this),children:[Object(f.jsx)(p.a,{name:"terminal"}),"Jobs"]}),Object(f.jsx)(m.a.Menu,{position:"right"})]})]})})}}]),n}(s.a.Component),v=Object(l.f)(Object(b.b)((function(e,t){return{}}),(function(e){return{}}))(O)),g=(n(210),""),x="1.0.6";var C=function(){return Object(f.jsx)("div",{className:"footer",children:Object(f.jsxs)("div",{className:"copyright",children:["\xa9 2021 v",x]})})},y=n(160),_=n(44),S=n.n(_),N=new(n(180).EventEmitter),k=n(12),E=n(72),w=n.n(E),D={GET_CONFIG_DATA_SUCCESS:"GET_CONFIG_DATA_SUCCESS",SAVE_CONFIG_DATA_SUCCESS:"SAVE_CONFIG_DATA_SUCCESS",SAVE_LOCAL_CONFIG_DATA_SUCCESS:"SAVE_LOCAL_CONFIG_DATA_SUCCESS",ADD_NEW_CLUSTER_SUCCESS:"ADD_NEW_CLUSTER_SUCCESS",REMOVE_CLUSTER_SUCCESS:"REMOVE_CLUSTER_SUCCESS",ADD_NEW_CLUSTER_HOST_SUCCESS:"ADD_NEW_CLUSTER_HOST_SUCCESS",REMOVE_CLUSTER_HOST_SUCCESS:"REMOVE_CLUSTER_HOST_SUCCESS",ADD_NEW_CLUSTER_PG_USER_SUCCESS:"ADD_NEW_CLUSTER_PG_USER_SUCCESS",REMOVE_CLUSTER_PG_USER_SUCCESS:"REMOVE_CLUSTER_PG_USER_SUCCESS",ADD_NEW_CLUSTER_PG_DATABASE_SUCCESS:"ADD_NEW_CLUSTER_PG_DATABASE_SUCCESS",REMOVE_CLUSTER_PG_DATABASE_SUCCESS:"REMOVE_CLUSTER_PG_DATABASE_SUCCESS",EDIT_CLUSTER_VARS_SUCCESS:"EDIT_CLUSTER_VARS_SUCCESS",SAVE_LOCAL_CLUSTER_VARS_CONFIG_SUCCESS:"SAVE_LOCAL_CLUSTER_VARS_CONFIG_SUCCESS",SAVE_LOCAL_CLUSTER_CONFIG_SUCCESS:"SAVE_LOCAL_CLUSTER_CONFIG_SUCCESS",GET_CURRENT_JOB_SUCCESS:"GET_CURRENT_JOB_SUCCESS",GET_JOB_LOGS_SUCCESS:"GET_JOB_LOGS_SUCCESS",DELETE_JOB_SUCCESS:"DELETE_JOB_SUCCESS",CREATE_JOB_SUCCESS:"CREATE_JOB_SUCCESS",GET_JOBS_SUCCESS:"GET_JOBS_SUCCESS"},U=n(29);S.a.interceptors.request.use((function(e){return e.timeout=1e4,e.headers={"content-type":"application/x-www-form-urlencoded"},e}),(function(e){return N.emit("showToasts",{type:"error",msg:e}),Promise.reject(e)})),S.a.interceptors.response.use((function(e){return!1===e.data.success&&N.emit("showToasts",{type:"error",msg:e.data}),e}),(function(e){return"Network Error"===e.message||-1!==e.message.indexOf("timeout")?N.emit("showToasts",{type:"error",msg:e.message}):N.emit("showToasts",{type:"error",msg:e.response.data.errorInfo}),Promise.reject(e)}));var T={getConfigData:function(e,t){return function(n){S()({method:"get",url:g+"/api/v1/config",data:w.a.stringify(Object(k.a)({},e))}).then((function(a){var s;(s="object"==typeof a.data?a.data:U.a.load(a.data)).hasOwnProperty("all")?(n(Object(k.a)({type:D.GET_CONFIG_DATA_SUCCESS,storeName:"configData",data:s},e)),"function"===typeof t&&t({success:!0,data:s})):"function"===typeof t&&t({success:!1,error:a.data})})).catch((function(e){}))}},saveConfigData:function(e,t){return function(n){S()({method:"post",url:g+"/api/v1/config/",data:e}).then((function(e){"ok"===e.data.message&&"function"===typeof t&&t({success:!0,data:e.data})})).catch((function(e){}))}},saveLocalConfigData:function(e,t){return function(n){n(Object(k.a)({type:D.SAVE_LOCAL_CONFIG_DATA_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},addNewCluster:function(e,t){return function(n){n(Object(k.a)({type:D.ADD_NEW_CLUSTER_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},removeCluster:function(e,t){return function(n){n(Object(k.a)({type:D.REMOVE_CLUSTER_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},addNewClusterHost:function(e,t){return function(n){n(Object(k.a)({type:D.ADD_NEW_CLUSTER_HOST_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},removeClusterHost:function(e,t){return function(n){n(Object(k.a)({type:D.REMOVE_CLUSTER_HOST_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},addNewClusterPgUser:function(e,t){return function(n){n(Object(k.a)({type:D.ADD_NEW_CLUSTER_PG_USER_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},removeClusterPgUser:function(e,t){return function(n){n(Object(k.a)({type:D.REMOVE_CLUSTER_PG_USER_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},addNewClusterPgDatabase:function(e,t){return function(n){n(Object(k.a)({type:D.ADD_NEW_CLUSTER_PG_DATABASE_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},removeClusterPgDatabase:function(e,t){return function(n){n(Object(k.a)({type:D.REMOVE_CLUSTER_PG_DATABASE_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},editClusterVars:function(e,t){return function(n){n(Object(k.a)({type:D.EDIT_CLUSTER_VARS_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},saveLocalClusterConfig:function(e,t){return function(n){n(Object(k.a)({type:D.SAVE_LOCAL_CLUSTER_CONFIG_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},saveLocalClusterVarsConfig:function(e,t){return function(n){n(Object(k.a)({type:D.SAVE_LOCAL_CLUSTER_VARS_CONFIG_SUCCESS,storeName:"configData"},e)),"function"===typeof t&&t({success:!0})}},getCurrentJob:function(e,t){return function(n){S()({method:"get",url:g+"/api/v1/job",data:w.a.stringify(Object(k.a)({},e))}).then((function(a){n(Object(k.a)({type:D.GET_CURRENT_JOB_SUCCESS,storeName:"jobs",data:a.data},e)),"function"===typeof t&&t({success:!0,data:a.data})})).catch((function(e){}))}},createJob:function(e,t){return function(n){S()({method:"post",url:g+"/api/v1/job"+e.cmd,data:w.a.stringify(Object(k.a)({},e))}).then((function(a){n(Object(k.a)({type:D.CREATE_JOB_SUCCESS,storeName:"jobs",data:a.data},e)),"function"===typeof t&&t({success:!0,data:a.data})})).catch((function(e){}))}},deleteJob:function(e,t){return function(n){S()({method:"DELETE",url:g+"/api/v1/job/",data:w.a.stringify(Object(k.a)({},e))}).then((function(a){n(Object(k.a)({type:D.DELETE_JOB_SUCCESS,storeName:"jobs",data:a.data},e)),"function"===typeof t&&t({success:!0,data:a.data})})).catch((function(e){"function"===typeof t&&t({success:!0,data:e})}))}},getJobs:function(e,t){return function(n){S()({method:"get",url:g+"/api/v1/jobs",data:w.a.stringify(Object(k.a)({},e))}).then((function(a){n(Object(k.a)({type:D.GET_JOBS_SUCCESS,storeName:"jobs",data:a.data.data},e)),"function"===typeof t&&t({success:!0,data:a.data.data})})).catch((function(e){}))}},getJobLogs:function(e,t){return function(n){S()({method:"get",url:g+"/api/v1/log/"+e.jobId,data:w.a.stringify(Object(k.a)({},e))}).then((function(a){n(Object(k.a)({type:D.GET_JOB_LOGS_SUCCESS,storeName:"jobLogs",data:a.data},e)),"function"===typeof t&&t({success:!0,data:a.data})})).catch((function(e){}))}}},R=n(391),L=n(108),A=n(392),I=n(384),H=n(395),J=n(388),P=n(47),G=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={},a.roleColor={primary:"orange",replica:"green",offline:"grey",standby:"blue",delayed:"purple"},a}return Object(u.a)(n,[{key:"_removeClusterHost",value:function(){var e=this.props,t=e.removeClusterHost,n=e.clusterName,a=e.hostName;N.emit("showConfirmBox",{content:Object(f.jsxs)("div",{className:"content",children:["It will remove instance ",Object(f.jsx)(L.a,{size:"large",children:a})," from config, are you sure?"]}),callback:function(e){e&&t({clusterName:n,hostName:a},(function(e){}))}})}},{key:"render",value:function(){var e=this.props,t=e.hostData,n=e.hostName,a=e.clusterName,s=[];if(t){var r=Object.keys(t).map((function(e,n){if(!["pg_role","pg_seq"].includes(e))return Object(f.jsxs)(L.a,{style:{background:"none"},children:[e,":",Object(f.jsx)(L.a.Detail,{children:t[e].toString()})]},"k-"+n)}));s=[].concat(Object(P.a)(s),Object(P.a)(r))}return Object(f.jsxs)(R.a.Item,{className:"mb-1rem",children:[Object(f.jsx)(y.a,{size:"mini",icon:"trash",basic:!0,className:"right floated no-shadow",onClick:this._removeClusterHost.bind(this)}),Object(f.jsx)(p.a,{name:"hdd",className:"left floated",fitted:!0,size:"large"}),Object(f.jsxs)(R.a.Content,{children:[Object(f.jsxs)(R.a.Header,{children:[Object(f.jsx)(L.a,{circular:!0,children:t.pg_seq}),Object(f.jsx)(L.a,{color:this.roleColor[t.pg_role],children:t.pg_role}),Object(f.jsxs)(L.a,{as:"a",color:"black",children:[a,"-",t.pg_seq]}),Object(f.jsxs)(L.a,{as:"a",color:"black",children:["@",n]})]}),Object(f.jsx)(R.a.Description,{className:"mt-5px",children:s})]})]})}}]),n}(s.a.Component),V=Object(l.f)(Object(b.b)((function(e,t){return{}}),(function(e){return{removeClusterHost:function(t,n){return e(T.removeClusterHost(t,n))}}}))(G)),F=n(393),B=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.desc;e.buttonText,e.buttomCallback,e.icon;return Object(f.jsxs)(F.a,{warning:!0,children:[t?Object(f.jsx)(F.a.Header,{children:t}):null,Object(f.jsx)("p",{children:n})]})}}]),n}(s.a.Component),q=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={},a}return Object(u.a)(n,[{key:"_removeClusterPgUser",value:function(e){var t=this.props,n=t.removeClusterPgUser,a=t.clusterName;N.emit("showConfirmBox",{content:Object(f.jsxs)("div",{className:"content",children:["It will remove user ",Object(f.jsx)(L.a,{size:"large",children:e})," from config, are you sure ?"]}),callback:function(t){t&&n({name:e,clusterName:a},(function(e){}))}})}},{key:"render",value:function(){var e=this.props.pgUser;return Object(f.jsxs)(R.a.Item,{className:"mb-5px",children:[Object(f.jsx)(y.a,{size:"mini",icon:"trash",basic:!0,className:"right floated no-shadow",onClick:this._removeClusterPgUser.bind(this,e.name)}),Object(f.jsx)(p.a,{name:"user",className:"left floated",fitted:!0,size:"large"}),Object(f.jsxs)(R.a.Content,{children:[Object(f.jsx)(R.a.Header,{children:Object(f.jsx)(L.a,{as:"a",color:"blue",children:e.name})}),Object(f.jsx)(R.a.Description,{className:"mt-5px",children:e.comment})]})]})}}]),n}(s.a.Component),M=Object(l.f)(Object(b.b)((function(e,t){return{}}),(function(e){return{removeClusterPgUser:function(t,n){return e(T.removeClusterPgUser(t,n))}}}))(q)),z=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={},a}return Object(u.a)(n,[{key:"_removeClusterPgDatabase",value:function(e){var t=this.props,n=t.removeClusterPgDatabase,a=t.clusterName;N.emit("showConfirmBox",{content:Object(f.jsxs)("div",{className:"content",children:["It will remove database ",Object(f.jsx)(L.a,{size:"large",children:e})," from config, are you sure ?"]}),callback:function(t){t&&n({name:e,clusterName:a},(function(e){}))}})}},{key:"render",value:function(){var e=this.props.pgDatabase;return Object(f.jsxs)(R.a.Item,{className:"mb-5px",children:[Object(f.jsx)(y.a,{size:"mini",icon:"trash",basic:!0,className:"right floated no-shadow",onClick:this._removeClusterPgDatabase.bind(this,e.name)}),Object(f.jsx)(p.a,{name:"database",className:"left floated",fitted:!0,size:"large"}),Object(f.jsxs)(R.a.Content,{children:[Object(f.jsx)(R.a.Header,{children:Object(f.jsx)(L.a,{as:"a",color:"brown",children:e.name})}),Object(f.jsx)(R.a.Description,{className:"mt-5px",children:e.comment})]})]})}}]),n}(s.a.Component),W=Object(l.f)(Object(b.b)((function(e,t){return{}}),(function(e){return{removeClusterPgDatabase:function(t,n){return e(T.removeClusterPgDatabase(t,n))}}}))(z)),K=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={},a}return Object(u.a)(n,[{key:"_renderHosts",value:function(){var e=this.props,t=e.clusterData,n=e.clusterName,a=[];return(null===t||void 0===t?void 0:t.hosts)&&(a=Object.keys(null===t||void 0===t?void 0:t.hosts).map((function(e,a){return Object(f.jsx)(V,{clusterName:n,hostName:e,hostData:t.hosts[e]},"key-"+a)}))),0===a.length?Object(f.jsx)(B,{desc:"No Instance"}):Object(f.jsx)(R.a,{children:a})}},{key:"_addNewClusterHost",value:function(){var e=this.props,t=e.clusterName,n=e.clusterData;N.emit("showEditClusterHostForm",{editType:"add",clusterName:t,clusterData:n,callback:function(e){}})}},{key:"_renderPgUsers",value:function(){var e,t=this.props,n=t.clusterData,a=t.clusterName,s=[];return(null===n||void 0===n||null===(e=n.vars)||void 0===e?void 0:e.pg_users)&&(s=n.vars.pg_users.map((function(e,t){return Object(f.jsx)(M,{clusterName:a,pgUser:e},"key-"+t)}))),0===s.length?Object(f.jsx)(B,{desc:"No Users"}):Object(f.jsx)(R.a,{children:s})}},{key:"_manageClusterPgUser",value:function(){var e=this.props,t=e.clusterName,n=e.clusterData;N.emit("showEditClusterPgUserForm",{clusterName:t,clusterData:n,callback:function(e){}})}},{key:"_renderPgDatabases",value:function(){var e,t=this.props,n=t.clusterData,a=t.clusterName,s=[];return(null===n||void 0===n||null===(e=n.vars)||void 0===e?void 0:e.pg_databases)&&(s=n.vars.pg_databases.map((function(e,t){return Object(f.jsx)(W,{clusterName:a,pgDatabase:e},"key-"+t)}))),0===s.length?Object(f.jsx)(B,{desc:"No Databases"}):Object(f.jsx)(R.a,{children:s})}},{key:"_addNewClusterPgDatabase",value:function(){var e=this.props,t=e.clusterName,n=e.clusterData;N.emit("showEditClusterPgDatabaseForm",{clusterName:t,clusterData:n,callback:function(e){}})}},{key:"_runScript",value:function(){var e=this.props,t=e.clusterName,n=e.createJob;N.emit("showConfirmBox",{content:Object(f.jsxs)("div",{className:"content",children:["It will",Object(f.jsx)(L.a,{size:"large",className:"color-red font-bold no-background",children:"init"}),"this cluster on nodes",Object(f.jsx)("br",{})," May",Object(f.jsx)(L.a,{size:"large",className:"color-red font-bold no-background",children:"remove"}),"existing cluster, Proceed?"]}),confirmButton:"Run",callback:function(e){e&&n({cmd:"?playbook=pgsql&cluster="+t,playbook:"pgsql",cluster:t},(function(e){var n,a;(null===(n=e.data)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.id)&&N.emit("showCmdViewer",{jobId:e.data.data.id,eventName:t,noLoop:!1})}))}})}},{key:"_removeCluster",value:function(){var e=this.props,t=e.clusterName,n=e.removeCluster,a=this;N.emit("showConfirmBox",{content:Object(f.jsxs)("div",{className:"content",children:["It will",Object(f.jsx)(L.a,{size:"large",className:"color-red font-bold no-background",children:"remove"}),"this cluster's definition from config, proceed?"]}),callback:function(e){e&&n({clusterName:t},(function(e){e.success&&a._saveAllYaml()}))}})}},{key:"_editClusterVars",value:function(){var e=this.props,t=e.clusterData,n=e.clusterName,a=e.saveLocalClusterVarsConfig;N.emit("showCodeEditor",{title:n+".vars",codeData:U.a.dump(t.vars),callback:function(e){var t=null;try{t=U.a.load(e)}catch(s){N.emit("showToasts",{type:"error",msg:s.toString()})}t&&a({configData:t,clusterName:n},(function(e){e.success&&N.emit("showToasts",{type:"success",msg:"save success"})}))}})}},{key:"_editClusterYaml",value:function(){var e=this.props,t=e.clusterData,n=e.clusterName,a=e.saveLocalClusterConfig;N.emit("showCodeEditor",{title:n,codeData:U.a.dump(t),callback:function(e){var t=null;try{t=U.a.load(e)}catch(s){N.emit("showToasts",{type:"error",msg:s.toString()})}t&&a({configData:t,clusterName:n},(function(e){e.success&&N.emit("showToasts",{type:"success",msg:"save success"})}))}})}},{key:"_saveAllYaml",value:function(){var e=this.props,t=e.configData,n=e.saveConfigData,a=JSON.parse(JSON.stringify(t));Object.keys(a.all.children).map((function(e){delete a.all.children[e].edit})),n(U.a.dump(a),(function(e){"ok"===e.data.message?N.emit("showToasts",{type:"success",msg:"save success"}):N.emit("showToasts",{type:"error",msg:e.data.message})}))}},{key:"_destroyCluster",value:function(){var e=this.props,t=e.clusterName,n=e.createJob;N.emit("showConfirmBox",{content:Object(f.jsxs)("div",{className:"content",children:["It will",Object(f.jsx)(L.a,{size:"large",className:"color-red font-bold no-background",children:"destroy"}),"this cluster from nodes, proceed?"]}),confirmButton:"Destroy",callback:function(e){e&&n({cmd:"?playbook=pgsql-remove&cluster="+t,playbook:"pgsql-remove",cluster:t},(function(e){var n,a;(null===(n=e.data)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.id)&&N.emit("showCmdViewer",{jobId:e.data.data.id,eventName:t,noLoop:!1})}))}})}},{key:"render",value:function(){var e,t,n=this.props,a=n.clusterData,r=n.clusterName,c=0;a.hasOwnProperty("hosts")&&(c=Object.keys(a.hosts).length);var i,l=0;(null===a||void 0===a||null===(e=a.vars)||void 0===e?void 0:e.pg_users)&&(l=null===a||void 0===a||null===(i=a.vars)||void 0===i?void 0:i.pg_users.length);var o,u=0;(null===a||void 0===a||null===(t=a.vars)||void 0===t?void 0:t.pg_databases)&&(u=null===a||void 0===a||null===(o=a.vars)||void 0===o?void 0:o.pg_databases.length);return Object(f.jsx)(s.a.Fragment,{children:Object(f.jsxs)(A.a,{fluid:!0,children:[Object(f.jsxs)(A.a.Content,{children:[Object(f.jsx)(p.a,{name:"server",className:"left floated mr-1rem",size:"large",style:{fontSize:"3rem",color:"#2680eb"}}),Object(f.jsx)("div",{className:"right floated",children:Object(f.jsxs)(y.a,{size:"mini",onClick:this._editClusterVars.bind(this),children:[Object(f.jsx)(p.a,{name:"setting"}),"Cluster Vars"]})}),Object(f.jsx)(A.a.Header,{style:{fontSize:"1.4em"},children:r}),Object(f.jsx)("div",{className:"flex-row-left",children:Object(f.jsxs)(A.a.Meta,{children:[Object(f.jsxs)(L.a,{size:"mini",className:"no-background",children:[Object(f.jsx)(p.a,{name:"hdd"})," ",c]}),Object(f.jsxs)(L.a,{size:"mini",className:"no-background",children:[Object(f.jsx)(p.a,{name:"users"})," ",l]}),Object(f.jsxs)(L.a,{size:"mini",className:"no-background",children:[Object(f.jsx)(p.a,{name:"database"})," ",u]})]})}),Object(f.jsx)(I.a,{}),Object(f.jsxs)("div",{className:"flex-row-between mt-1rem",children:[Object(f.jsx)(H.a,{as:"h4",style:{margin:"0"},children:"Instances"}),Object(f.jsxs)(y.a,{size:"mini",onClick:this._addNewClusterHost.bind(this),children:[Object(f.jsx)(p.a,{name:"plus"}),"New Instance"]})]}),Object(f.jsx)(I.a,{}),Object(f.jsx)(A.a.Content,{children:this._renderHosts()}),Object(f.jsxs)("div",{className:"flex-row-between mt-1rem",children:[Object(f.jsx)(H.a,{as:"h4",style:{margin:"0"},children:"Users"}),Object(f.jsxs)(y.a,{size:"mini",onClick:this._manageClusterPgUser.bind(this),children:[Object(f.jsx)(p.a,{name:"plus"}),"New User"]})]}),Object(f.jsx)(I.a,{}),Object(f.jsx)(A.a.Content,{children:this._renderPgUsers()}),Object(f.jsxs)("div",{className:"flex-row-between mt-1rem",children:[Object(f.jsx)(H.a,{as:"h4",style:{margin:"0"},children:"Databases"}),Object(f.jsxs)(y.a,{size:"mini",onClick:this._addNewClusterPgDatabase.bind(this),children:[Object(f.jsx)(p.a,{name:"plus"}),"New Database"]})]}),Object(f.jsx)(I.a,{}),Object(f.jsx)(A.a.Content,{children:this._renderPgDatabases()})]}),Object(f.jsx)(A.a.Content,{extra:!0,children:Object(f.jsxs)("div",{className:"flex-row-right",children:[Object(f.jsx)(J.a,{content:"Init Cluster",trigger:Object(f.jsx)(y.a,{disabled:a.edit,icon:"play",onClick:this._runScript.bind(this)})}),Object(f.jsx)(J.a,{content:"Destroy Cluster",trigger:Object(f.jsx)(y.a,{disabled:a.edit,icon:"bomb",onClick:this._destroyCluster.bind(this)})}),Object(f.jsx)(J.a,{content:"Edit Cluster Config",trigger:Object(f.jsx)(y.a,{icon:"code",onClick:this._editClusterYaml.bind(this)})}),Object(f.jsx)(J.a,{content:"Remove Cluster Config",trigger:Object(f.jsx)(y.a,{disabled:a.edit,icon:"trash",onClick:this._removeCluster.bind(this)})})]})})]})})}}]),n}(s.a.Component),Y=Object(l.f)(Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{removeCluster:function(t,n){return e(T.removeCluster(t,n))},addNewClusterHost:function(t,n){return e(T.addNewClusterHost(t,n))},saveLocalClusterVarsConfig:function(t,n){return e(T.saveLocalClusterVarsConfig(t,n))},saveLocalClusterConfig:function(t,n){return e(T.saveLocalClusterConfig(t,n))},saveConfigData:function(t,n){return e(T.saveConfigData(t,n))},createJob:function(t,n){return e(T.createJob(t,n))}}}))(K)),Z=(n(231),function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"_renderClusters",value:function(){var e=this.props.configData;return Object.keys(e.all.children).map((function(t,n){var a=e.all.children[t];if("meta"!=t)return Object(f.jsx)(Y,{clusterData:a,clusterName:t},"key-"+n)}))}},{key:"_addNewCluster",value:function(){N.emit("showEditClusterForm",{editType:"add",callback:function(e){}})}},{key:"_saveAllYaml",value:function(){var e=this,t=this.props,n=t.configData,a=t.saveConfigData,s=JSON.parse(JSON.stringify(n));Object.keys(s.all.children).map((function(e){delete s.all.children[e].edit})),a(U.a.dump(s),(function(t){"ok"===t.data.message?(N.emit("showToasts",{type:"success",msg:"save success"}),e._getConfigData()):N.emit("showToasts",{type:"error",msg:t.data.message})}))}},{key:"_getConfigData",value:function(){(0,this.props.getConfigData)({},(function(e){}))}},{key:"render",value:function(){var e=this.props.configData,t=!1;return Object.keys(e.all.children).map((function(n){e.all.children[n].edit&&(t=!0)})),Object(f.jsx)(s.a.Fragment,{children:Object(f.jsxs)("div",{className:"page-wrap",children:[Object(f.jsx)("div",{className:"flex-row-right mb-1rem",children:Object(f.jsxs)(y.a,{primary:!0,onClick:this._addNewCluster.bind(this),children:[Object(f.jsx)(p.a,{name:"plus"}),"New Cluster"]})}),Object(f.jsx)("div",{style:{marginBottom:"2rem"},children:this._renderClusters()}),t?Object(f.jsxs)("div",{className:"flex-row-center dbActions",children:[Object(f.jsxs)(y.a,{onClick:this._getConfigData.bind(this),children:[Object(f.jsx)(p.a,{name:"refresh"}),"Reset"]}),Object(f.jsxs)(y.a,{color:"orange",onClick:this._saveAllYaml.bind(this),children:[Object(f.jsx)(p.a,{name:"save"}),"Save Config"]})]}):null]})})}}]),n}(s.a.Component)),$=Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{getConfigData:function(t,n){return e(T.getConfigData(t,n))},saveConfigData:function(t,n){return e(T.saveConfigData(t,n))}}}))(Z),Q=n(63),X=n(390),ee=(n(52),n(389)),te=n(385),ne=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={cmd:""},a}return Object(u.a)(n,[{key:"runScript",value:function(){var e=this.state.cmd;N.emit("showConfirmBox",{content:"Are you sure run this script ?",confirmButton:"Run",callback:function(t){t&&N.emit("showCmdViewer",{sseUrl:g+"/api/v1/infra "+e,eventName:"pigsty-cli"})}})}},{key:"render",value:function(){var e=this;return Object(Q.a)(this.props),Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Infra Provision"}),Object(f.jsx)("div",{className:"lead",children:"How to pull up infrasturcture on meta node"}),Object(f.jsx)("h2",{id:"overview",children:"Overview"}),Object(f.jsxs)("p",{children:["Infrastructure initialization is done via ",Object(f.jsx)("a",{href:"https://github.com/Vonng/pigsty/blob/master/infra.yml",children:Object(f.jsx)("code",{children:"infra.yml"})}),". The script completes the installation and deployment of ",Object(f.jsx)("strong",{children:"infrastructure"})," on the ",Object(f.jsx)("strong",{children:"meta node"}),"."]}),Object(f.jsxs)("p",{children:["``infra.yml",Object(f.jsx)("code",{children:"takes the metanode (default group name"}),"meta`) as the deployment target."]}),Object(f.jsx)("div",{className:"highlight",children:Object(f.jsx)("pre",{children:Object(f.jsx)("code",{className:"language-bash","data-lang":"bash",children:". /infra.yml"})})}),Object(f.jsxs)("p",{children:["! ",Object(f.jsx)("a",{href:"/img/play/infra.svg"})]}),Object(f.jsx)("h2",{id:"caution",children:"Caution"}),Object(f.jsx)("p",{children:Object(f.jsx)("strong",{children:"\u2757\ufe0f The initialization of the meta node must be completed before the initialization of the database node can be executed properly"})}),Object(f.jsxs)("p",{children:[Object(f.jsx)("code",{children:"infra.yml"})," is fixed to work on the group named ",Object(f.jsx)("a",{href:"https://github.com/Vonng/pigsty/blob/master/pigsty.yml#L32",children:Object(f.jsx)("code",{children:"meta"})})," in the configuration file"]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:"meta nodes"})," can be reused as ",Object(f.jsx)("strong",{children:"normal nodes"}),", i.e. PostgreSQL databases can be defined and created on meta nodes as well."]}),Object(f.jsxs)("p",{children:["Pigsty recommends using the default configuration and creating a cluster of ",Object(f.jsx)("a",{href:"https://github.com/Vonng/pigsty/blob/master/pigsty.yml#L43",children:Object(f.jsx)("code",{children:"pg-meta"})})," meta-databases on the meta-nodes for hosting Pigsty advanced features."]}),Object(f.jsx)("p",{children:"A complete execution of the initialization process can take 2 to 8 minutes, depending on the machine configuration."}),Object(f.jsx)("h2",{id:"selective-execution",children:"Selective execution"}),Object(f.jsxs)("p",{children:["Users can ",Object(f.jsx)("strong",{children:"selectively execute"})," a subset of scripts through ansible\u2019s tagging mechanism."]}),Object(f.jsx)("p",{children:"For example, if you want to execute only the local source initialization part, you can do so with the following command."}),Object(f.jsx)("div",{className:"highlight",children:Object(f.jsx)("pre",{children:Object(f.jsxs)("code",{className:"language-bash","data-lang":"bash",children:[". /infra.yml --tags",Object(f.jsx)("span",{children:"="}),"repo"]})})}),Object(f.jsxs)("p",{children:["Please refer to [",Object(f.jsx)("strong",{children:"task details"}),"](#task details) for specific tags"]}),Object(f.jsx)("p",{children:"Some common subsets of tasks include."}),Object(f.jsx)("div",{className:"highlight",children:Object(f.jsx)("pre",{children:Object(f.jsxs)("code",{className:"language-bash","data-lang":"bash",children:[". /infra.yml --tags",Object(f.jsx)("span",{children:"="}),"repo -e ",Object(f.jsx)("span",{children:"repo_rebuild"}),Object(f.jsx)("span",{children:"="}),Object(f.jsx)("span",{children:"true"}),Object(f.jsx)("span",{children:"# Force a local source to be recreated"}),". /infra.yml --tags",Object(f.jsx)("span",{children:"="}),"prometheus_reload ",Object(f.jsx)("span",{children:"# Reload Prometheus configuration"}),". /infra.yml --tags",Object(f.jsx)("span",{children:"="}),"nginx_haproxy ",Object(f.jsx)("span",{children:"# Regenerate the Nginx Haproxy index page"}),". /infra.yml --tags",Object(f.jsx)("span",{children:"="}),"prometheus_targets,prometheus_reload ",Object(f.jsx)("span",{children:"# Regenerate the Prometheus static monitoring object file and apply"})]})})}),Object(f.jsx)("h2",{id:"script-description",children:"script description"}),Object(f.jsxs)("p",{children:[Object(f.jsx)("a",{href:"https://github.com/Vonng/pigsty/blob/master/infra.yml",children:Object(f.jsx)("code",{children:"infra.yml"})})," does the following stuff:"]}),Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:"Deploy and enable local sources"}),Object(f.jsx)("li",{children:"Complete metanode initialization"}),Object(f.jsxs)("li",{children:["Complete meta-node infrastructure initialization",Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:"CA infrastructure"}),Object(f.jsx)("li",{children:"DNS Nameserver"}),Object(f.jsx)("li",{children:"Nginx"}),Object(f.jsx)("li",{children:"Prometheus & Alertmanger"}),Object(f.jsx)("li",{children:"Grafana"})]})]}),Object(f.jsx)("li",{children:"Copy the Pigsty ontology to the meta node"}),Object(f.jsx)("li",{children:"Complete database initialization on the meta node (optional, users can reuse the meta node through the standard database cluster initialization process)"})]})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)("code",{className:"code",style:{width:"12rem"},children:"./infra.yml "}),Object(f.jsx)(te.a,{fluid:!0,className:"code",placeholder:"--tags=",onChange:function(t,n){n.name;var a=n.value;e.setState({cmd:a})}}),Object(f.jsx)(y.a,{primary:!0,type:"submit",onClick:this.runScript.bind(this),children:"Run"})]})]})})]})}}]),n}(s.a.Component),ae=Object(b.b)((function(e,t){return{}}),(function(e){return{}}))(ne),se=n(386),re=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={clusterName:"",cmd:""},a}return Object(u.a)(n,[{key:"runScript",value:function(){var e=this.state,t=e.clusterName,n=e.cmd;if(0===t.length)return!1;N.emit("showConfirmBox",{content:"Are you sure run this script ?",confirmButton:"Run",callback:function(e){e&&N.emit("showCmdViewer",{sseUrl:g+"/api/v1/pgsql -l "+t+" "+n,eventName:t})}})}},{key:"render",value:function(){var e=this,t=this.props.configData,n=Object.keys(t.all.children).map((function(e){return{key:e,text:e,value:e}}));return Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Pgsql Provision"}),Object(f.jsx)("div",{className:"lead",children:"How to define and create postgres clusters?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)("code",{className:"code",style:{width:"18rem"},children:"./pgsql.yml -l "}),Object(f.jsx)(se.a,{className:"code",style:{width:"14rem"},compact:!0,options:n,onChange:function(t,n){n.name;var a=n.value;e.setState({clusterName:a})}}),Object(f.jsx)(te.a,{fluid:!0,className:"code",placeholder:"--tags=",onChange:function(t,n){n.name;var a=n.value;e.setState({cmd:a})}}),Object(f.jsx)(y.a,{primary:!0,type:"submit",onClick:this.runScript.bind(this),children:"Run"})]})]})})]})}}]),n}(s.a.Component),ce=Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{}}))(re),ie=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={cmd:""},a}return Object(u.a)(n,[{key:"runScript",value:function(){var e=this.state.cmd;N.emit("showConfirmBox",{content:"Are you sure run this script ?",confirmButton:"Run",callback:function(t){t&&N.emit("showCmdViewer",{sseUrl:g+"/api/v1/sandbox "+e,eventName:"pigsty-cli"})}})}},{key:"render",value:function(){var e=this;return Object(Q.a)(this.props),Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Sandbox Provision"}),Object(f.jsx)("div",{className:"lead",children:"How to perform one-pass bootstrap for sandbox?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)("code",{className:"code",style:{width:"12rem"},children:"./sandbox.yml "}),Object(f.jsx)(te.a,{fluid:!0,className:"code",placeholder:"--tags=",onChange:function(t,n){n.name;var a=n.value;e.setState({cmd:a})}}),Object(f.jsx)(y.a,{primary:!0,type:"submit",onClick:this.runScript.bind(this),children:"Run"})]})]})})]})}}]),n}(s.a.Component),le=Object(b.b)((function(e,t){return{}}),(function(e){return{}}))(ie),oe=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={clusterName:"",cmd:""},a}return Object(u.a)(n,[{key:"runScript",value:function(){var e=this.state,t=e.clusterName,n=e.cmd;if(0===t.length)return!1;N.emit("showConfirmBox",{content:"Are you sure run this script ?",confirmButton:"Run",callback:function(e){e&&N.emit("showCmdViewer",{sseUrl:g+"/api/v1/pgsql-remove -l "+t+" "+n,eventName:t})}})}},{key:"render",value:function(){var e=this,t=this.props.configData,n=Object.keys(t.all.children).map((function(e){return{key:e,text:e,value:e}}));return Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Remove Clusters"}),Object(f.jsx)("div",{className:"lead",children:"How to destroy postgres clusters and instances"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)("code",{className:"code",style:{width:"32rem"},children:"./pgsql-remove.yml -l "}),Object(f.jsx)(se.a,{className:"code",style:{width:"14rem"},compact:!0,options:n,onChange:function(t,n){n.name;var a=n.value;e.setState({clusterName:a})}}),Object(f.jsx)(te.a,{fluid:!0,className:"code",placeholder:"--tags=",onChange:function(t,n){n.name;var a=n.value;e.setState({cmd:a})}}),Object(f.jsx)(y.a,{primary:!0,type:"submit",onClick:this.runScript.bind(this),children:"Run"})]})]})})]})}}]),n}(s.a.Component),ue=Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{}}))(oe),de=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={clusterName:"",cmd:""},a}return Object(u.a)(n,[{key:"runScript",value:function(){var e=this.state,t=e.clusterName,n=e.cmd;if(0===t.length)return!1;N.emit("showConfirmBox",{content:"Are you sure run this script ?",confirmButton:"Run",callback:function(e){e&&N.emit("showCmdViewer",{sseUrl:g+"/api/v1/pgsql-monitor -l "+t+" "+n,eventName:t})}})}},{key:"render",value:function(){var e=this,t=this.props.configData,n=Object.keys(t.all.children).map((function(e){return{key:e,text:e,value:e}}));return Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Monitor Only"}),Object(f.jsx)("div",{className:"lead",children:"How to deploy pigsty monitoring system without provisioning solution?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)("code",{className:"code",style:{width:"32rem"},children:"./pgsql-monitor.yml -l "}),Object(f.jsx)(se.a,{className:"code",style:{width:"14rem"},compact:!0,options:n,onChange:function(t,n){n.name;var a=n.value;e.setState({clusterName:a})}}),Object(f.jsx)(te.a,{fluid:!0,className:"code",placeholder:"--tags=",onChange:function(t,n){n.name;var a=n.value;e.setState({cmd:a})}}),Object(f.jsx)(y.a,{primary:!0,type:"submit",onClick:this.runScript.bind(this),children:"Run"})]})]})})]})}}]),n}(s.a.Component),je=Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{}}))(de),be=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={clusterName:"",cmd:""},a}return Object(u.a)(n,[{key:"runScript",value:function(){var e=this.state,t=e.clusterName,n=e.cmd;if(0===t.length)return!1;N.emit("showConfirmBox",{content:"Are you sure run this script ?",confirmButton:"Run",callback:function(e){e&&N.emit("showCmdViewer",{sseUrl:g+"/api/v1/pgsql-createuser -l "+t+" "+n,eventName:t})}})}},{key:"render",value:function(){var e=this,t=this.props.configData,n=Object.keys(t.all.children).map((function(e){return{key:e,text:e,value:e}}));return Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Create User"}),Object(f.jsx)("div",{className:"lead",children:"How to perform one-pass bootstrap for sandbox?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)("code",{className:"code",style:{width:"33rem"},children:"./pgsql-createuser.yml -l "}),Object(f.jsx)(se.a,{className:"code",style:{width:"14rem"},compact:!0,options:n,onChange:function(t,n){n.name;var a=n.value;e.setState({clusterName:a})}}),Object(f.jsx)(te.a,{fluid:!0,className:"code",placeholder:"--tags=",onChange:function(t,n){n.name;var a=n.value;e.setState({cmd:a})}}),Object(f.jsx)(y.a,{primary:!0,type:"submit",onClick:this.runScript.bind(this),children:"Run"})]})]})})]})}}]),n}(s.a.Component),he=Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{}}))(be),me=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={clusterName:"",cmd:""},a}return Object(u.a)(n,[{key:"runScript",value:function(){var e=this.state,t=e.clusterName,n=e.cmd;if(0===t.length)return!1;N.emit("showConfirmBox",{content:"Are you sure run this script ?",confirmButton:"Run",callback:function(e){e&&N.emit("showCmdViewer",{sseUrl:g+"/api/v1/pgsql-createdb -l "+t+" "+n,eventName:t})}})}},{key:"render",value:function(){var e=this,t=this.props.configData,n=Object.keys(t.all.children).map((function(e){return{key:e,text:e,value:e}}));return Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Create Database"}),Object(f.jsx)("div",{className:"lead",children:"How to create new database on running clusters?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)("code",{className:"code",style:{width:"32rem"},children:"./pgsql-createdb.yml -l "}),Object(f.jsx)(se.a,{className:"code",style:{width:"14rem"},compact:!0,options:n,onChange:function(t,n){n.name;var a=n.value;e.setState({clusterName:a})}}),Object(f.jsx)(te.a,{fluid:!0,className:"code",placeholder:"--tags=",onChange:function(t,n){n.name;var a=n.value;e.setState({cmd:a})}}),Object(f.jsx)(y.a,{primary:!0,type:"submit",onClick:this.runScript.bind(this),children:"Run"})]})]})})]})}}]),n}(s.a.Component),pe=Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{}}))(me),fe=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={clusterName:"",cmd:""},a}return Object(u.a)(n,[{key:"runScript",value:function(){var e=this.state,t=e.clusterName,n=e.cmd;if(0===t.length)return!1;N.emit("showConfirmBox",{content:"Are you sure run this script ?",confirmButton:"Run",callback:function(e){e&&N.emit("showCmdViewer",{sseUrl:g+"/api/v1/pgsql-service -l "+t+" "+n,eventName:t})}})}},{key:"render",value:function(){var e=this,t=this.props.configData,n=Object.keys(t.all.children).map((function(e){return{key:e,text:e,value:e}}));return Object(f.jsxs)("div",{className:"playbook-item",children:[Object(f.jsxs)("div",{className:"playbook-item-intro",children:[Object(f.jsx)("h1",{children:"Service Provision"}),Object(f.jsx)("div",{className:"lead",children:"How to perform one-pass bootstrap for sandbox?"})]}),Object(f.jsx)(ee.a,{className:"playbook-item-run-script",children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Run Script"}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)("code",{className:"code",style:{width:"32rem"},children:"./pgsql-service.yml -l "}),Object(f.jsx)(se.a,{className:"code",style:{width:"14rem"},compact:!0,options:n,onChange:function(t,n){n.name;var a=n.value;e.setState({clusterName:a})}}),Object(f.jsx)(te.a,{fluid:!0,className:"code",placeholder:"--tags=",onChange:function(t,n){n.name;var a=n.value;e.setState({cmd:a})}}),Object(f.jsx)(y.a,{primary:!0,type:"submit",onClick:this.runScript.bind(this),children:"Run"})]})]})})]})}}]),n}(s.a.Component),Oe=Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{}}))(fe),ve=[{menuItem:{key:"infraProvision",icon:"arrow alternate circle right outline",content:"Infra Provision"},render:function(){return Object(f.jsx)(X.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(ae,{})})}},{menuItem:{key:"pgsqlProvision",icon:"arrow alternate circle right outline",content:"Pgsql Provision"},render:function(){return Object(f.jsx)(X.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(ce,{})})}},{menuItem:{key:"sandboxProvision",icon:"arrow alternate circle right outline",content:"Sandbox Provision"},render:function(){return Object(f.jsx)(X.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(le,{})})}},{menuItem:{key:"removeClusters",icon:"arrow alternate circle right outline",content:"Remove Clusters"},render:function(){return Object(f.jsx)(X.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(ue,{})})}},{menuItem:{key:"monitorOnly",icon:"arrow alternate circle right outline",content:"Monitor Only"},render:function(){return Object(f.jsx)(X.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(je,{})})}},{menuItem:{key:"createUser",icon:"arrow alternate circle right outline",content:"Create User"},render:function(){return Object(f.jsx)(X.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(he,{})})}},{menuItem:{key:"createDatabase",icon:"arrow alternate circle right outline",content:"Create Database"},render:function(){return Object(f.jsx)(X.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(pe,{})})}},{menuItem:{key:"serviceProvision",icon:"arrow alternate circle right outline",content:"Service Provision"},render:function(){return Object(f.jsx)(X.a.Pane,{className:"playbook-pane",children:Object(f.jsx)(Oe,{})})}}],ge=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(Q.a)(this.props),Object(f.jsx)("div",{className:"page-wrap playbook",children:Object(f.jsx)(X.a,{menu:{fluid:!0,vertical:!0,tabular:!0},panes:ve})})}}]),n}(s.a.Component),xe=Object(b.b)((function(e,t){return{}}),(function(e){return{}}))(ge),Ce=(n(232),n(64)),ye=(n(150),n(151),n(112),n(152),n(153),n(238),function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).codeM=null,a}return Object(u.a)(n,[{key:"_goToPlaybook",value:function(){this.props.history.push("/playbook")}},{key:"_saveYaml",value:function(){var e=this.props,t=e.saveLocalConfigData,n=e.saveConfigData,a=null;try{a=U.a.load(this.codeM.editor.getValue())}catch(s){N.emit("showToasts",{type:"error",msg:s.toString()})}a&&t({data:a},(function(e){if(e.success){var t=JSON.parse(JSON.stringify(a));Object.keys(t.all.children).map((function(e){delete t.all.children[e].edit})),n(U.a.dump(t),(function(e){"ok"===e.data.message?N.emit("showToasts",{type:"success",msg:"save success"}):N.emit("showToasts",{type:"error",msg:e.data.message})}))}}))}},{key:"render",value:function(){var e=this.props.configData,t=this,n=JSON.parse(JSON.stringify(e));Object.keys(n.all.children).map((function(e){delete n.all.children[e].edit}));var a=U.a.dump(n);return Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{className:"codeViewer",children:Object(f.jsx)(Ce.a,{ref:function(e){(null===e||void 0===e?void 0:e.editor)&&(t.codeM=e)},value:a,options:{theme:"monokai",tabSize:2,keyMap:"sublime",mode:"yaml"}})}),Object(f.jsx)(I.a,{}),Object(f.jsx)("div",{children:Object(f.jsx)(y.a,{primary:!0,onClick:this._saveYaml.bind(this),children:"Save Config"})})]})}}]),n}(s.a.Component)),_e=Object(l.f)(Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{saveLocalConfigData:function(t,n){return e(T.saveLocalConfigData(t,n))},saveConfigData:function(t,n){return e(T.saveConfigData(t,n))}}}))(ye)),Se=[{menuItem:{key:"YAML",icon:"code",content:"Config"},render:function(){return Object(f.jsx)(X.a.Pane,{children:Object(f.jsx)(_e,{})})}}],Ne=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"render",value:function(){return Object(Q.a)(this.props),Object(f.jsx)("div",{className:"page-wrap pigsty-config",children:Object(f.jsx)(X.a,{panes:Se})})}}]),n}(s.a.Component),ke=Object(b.b)((function(e,t){return{}}),(function(e){return{}}))(Ne),Ee=(n(154),function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={open:!1,renderCode:"",jobInfo:null,noRunningJob:!1},a.codeMirrorRef=null,a.timer=null,a.timerGap=5e3,a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this._getCurrentJob()}},{key:"componentWillUnmount",value:function(){this.timer&&clearInterval(this.timer)}},{key:"_getCurrentJob",value:function(){var e=this;(0,this.props.getCurrentJob)({},(function(t){t.data.data?e.setState({jobInfo:t.data.data,noRunningJob:!1},(function(){"running"===t.data.data.status&&e._startLogTimer()})):e.setState({noRunningJob:!0})}))}},{key:"_startLogTimer",value:function(){var e=this;e._getJobLogs(),this.timer=setInterval((function(){e._getJobLogs()}),this.timerGap)}},{key:"_getJobLogs",value:function(){var e=this.state.jobInfo,t=this.props.getJobLogs,n=this;t({jobId:e.id},(function(e){n.setState({renderCode:e.data},(function(){n.codeMirrorRef.editor&&n.codeMirrorRef.editor.scrollTo(0,n.codeMirrorRef.editor.getScrollInfo().height)}))}))}},{key:"stopJob",value:function(){var e=this,t=this.state.jobInfo,n=this.props.deleteJob;N.emit("showConfirmBox",{content:"Are you sure stop this Job ?",confirmButton:"Stop",callback:function(a){a&&n({jobid:t.jobId},(function(t){"job deleted"===t.data.message?(N.emit("showToasts",{type:"success",msg:"save success"}),e._getCurrentJob()):N.emit("showToasts",{type:"error",msg:t.data.message})}))}})}},{key:"render",value:function(){var e=this,t=(this.props.configData,this.state),n=t.renderCode,a=t.jobInfo,s=t.noRunningJob;return Object(f.jsxs)("div",{className:"current-job",children:[Object(f.jsxs)("div",{className:"intro mb-1rem",children:[Object(f.jsx)("h1",{children:"Current Job"}),Object(f.jsxs)(L.a,{children:["Command:",null===a||void 0===a?void 0:a.command," "]}),Object(f.jsxs)(L.a,{className:"mb-1rem",children:["Start time:",null===a||void 0===a?void 0:a.start_at," "]})]}),s?Object(f.jsx)(B,{desc:"No Running Job"}):null,n.length>0?Object(f.jsx)("div",{className:"job-log-viewer",children:Object(f.jsx)(Ce.a,{ref:function(t){e.codeMirrorRef=t},value:n,options:{lineWrapping:!0,theme:"monokai",tabSize:2,keyMap:"sublime",mode:"shell",readOnly:"nocursor",lineNumbers:!1,autofocus:!1}})}):null,"running"===(null===a||void 0===a?void 0:a.status)?Object(f.jsx)("div",{className:"flex-row-right mt-1rem",children:Object(f.jsx)(y.a,{color:"red",onClick:this.stopJob.bind(this),children:"Stop Job"})}):null]})}}]),n}(s.a.Component)),we=Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{deleteJob:function(t,n){return e(T.deleteJob(t,n))},getJobLogs:function(t,n){return e(T.getJobLogs(t,n))},getCurrentJob:function(t,n){return e(T.getCurrentJob(t,n))}}}))(Ee),De=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={loading:!0},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this._getJobs()}},{key:"_getJobs",value:function(){(0,this.props.getJobs)({},(function(e){}))}},{key:"showCmdViewer",value:function(e){N.emit("showCmdViewer",{jobId:e,eventName:"",noLoop:!0})}},{key:"_renderJobItems",value:function(){var e,t=this;return 0===(e=this.props.jobs.list.map((function(e,n){return Object(f.jsxs)(R.a.Item,{className:"mb-5px",children:[Object(f.jsx)(J.a,{content:"View Logs",trigger:Object(f.jsxs)(y.a,{primary:!0,className:"right floated",onClick:t.showCmdViewer.bind(t,e.id),children:[Object(f.jsx)(p.a,{name:"code"}),"View Logs"]})}),Object(f.jsx)(p.a,{name:"sticky note outline",className:"left floated",fitted:!0,size:"large"}),Object(f.jsxs)(R.a.Content,{children:[Object(f.jsx)(R.a.Header,{as:"a",onClick:t.showCmdViewer.bind(t,e.id),children:e.command}),Object(f.jsx)(R.a.Description,{className:"mt-5px",children:e.start_at})]}),Object(f.jsx)(I.a,{})]},"key"+n)}))).length?Object(f.jsx)(B,{desc:"No History Data"}):Object(f.jsx)(R.a,{children:e})}},{key:"render",value:function(){this.props.jobs;return Object(f.jsxs)("div",{className:"history-jobs",children:[Object(f.jsx)("div",{className:"intro",children:Object(f.jsx)("h1",{children:"History Jobs"})}),Object(f.jsx)("div",{className:"history-jobs-list",children:this._renderJobItems()})]})}}]),n}(s.a.Component),Ue=Object(b.b)((function(e,t){return{jobs:e.jobs}}),(function(e){return{getJobs:function(t,n){return e(T.getJobs(t,n))}}}))(De),Te=[{menuItem:{key:"currentJobLog",icon:"arrow alternate circle right outline",content:"Current Job"},render:function(){return Object(f.jsx)(X.a.Pane,{className:"job-pane",children:Object(f.jsx)(we,{})})}},{menuItem:{key:"historyJobs",icon:"arrow alternate circle right outline",content:"History Jobs"},render:function(){return Object(f.jsx)(X.a.Pane,{className:"job-pane",children:Object(f.jsx)(Ue,{})})}}],Re=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"_renderJobs",value:function(){var e=this.props.configData;return Object.keys(e.all.children).map((function(t,n){e.all.children[t];return null}))}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(f.jsx)("div",{className:"page-wrap jobs",children:Object(f.jsx)(X.a,{menu:{fluid:!0,vertical:!0,tabular:!0},panes:Te})})}}]),n}(s.a.Component),Le=Object(b.b)((function(e,t){return{configData:e.configData,jobs:e.jobs}}),(function(e){return{getJobs:function(t,n){return e(T.getJobs(t,n))}}}))(Re),Ae=n(143),Ie=(n(239),n(240),function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={open:!1,renderCode:"Loading...",eventName:"",sseUrl:"",jobId:"",noLoop:!1},a.codeMirrorRef=null,a.timer=null,a.timerGap=1e3,a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=N.addListener("showCmdViewer",(function(t){e.setState({open:!0,renderCode:"Loading...",sseUrl:t.sseUrl,eventName:t.eventName,jobId:t.jobId,noLoop:t.noLoop||!1},(function(){e._startLogTimer()}))}))}},{key:"_startLogTimer",value:function(){var e=this.state,t=(e.jobId,e.noLoop),n=(this.props.getJobLogs,this);this._getJobLogs(),t||(this.timer=setInterval((function(){n._getJobLogs()}),this.timerGap))}},{key:"_getJobLogs",value:function(){var e=this.state.jobId,t=this.props.getJobLogs,n=this;t({jobId:e},(function(e){n.setState({renderCode:e.data},(function(){var e;(null===(e=n.codeMirrorRef)||void 0===e?void 0:e.editor)&&n.codeMirrorRef.editor.scrollTo(0,n.codeMirrorRef.editor.getScrollInfo().height)}))}))}},{key:"closeModal",value:function(){this.streamSSE&&this.streamSSE.close(),this.timer&&clearInterval(this.timer),this.setState({open:!1})}},{key:"_openSSE",value:function(){var e,t=this.state,n=t.eventName,a=t.sseUrl,s=this;this.streamSSE&&this.streamSSE.close(),this.streamSSE=new EventSource(a),null===(e=this.streamSSE)||void 0===e||e.addEventListener(n,(function(e){s.setState({renderCode:s.state.renderCode+e.data},(function(){var e;(null===(e=s.codeMirrorRef)||void 0===e?void 0:e.editor)&&s.codeMirrorRef.editor.scrollTo(0,s.codeMirrorRef.editor.getScrollInfo().height)}))}))}},{key:"stopCmd",value:function(){var e=this.state.jobId,t=this.props.deleteJob;N.emit("showConfirmBox",{content:"Are you sure stop this script ?",confirmButton:"Stop",callback:function(n){n&&t({jobid:e},(function(e){"job deleted"===e.data.message?N.emit("showToasts",{type:"success",msg:"stop success"}):N.emit("showToasts",{type:"error",msg:e.data.message})}))}})}},{key:"render",value:function(){var e=this,t=this.state,n=t.renderCode,a=t.open,s=t.noLoop;return Object(f.jsxs)(Ae.a,{closeIcon:!0,open:a,centered:!1,className:"modal-cmdviewer",onClose:this.closeModal.bind(this),children:[Object(f.jsx)(Ae.a.Header,{children:"Console Logs"}),Object(f.jsx)(Ae.a.Content,{scrolling:!0,children:Object(f.jsx)("div",{className:"cmdViewer",children:Object(f.jsx)(Ce.a,{ref:function(t){e.codeMirrorRef=t},value:n,options:{theme:"monokai",tabSize:2,keyMap:"sublime",mode:"shell",readOnly:"nocursor",lineNumbers:!1,autofocus:!1,lineWrapping:!0}})})}),Object(f.jsxs)(Ae.a.Actions,{children:[s?null:Object(f.jsx)(y.a,{onClick:this.stopCmd.bind(this),children:"Stop"}),Object(f.jsx)(y.a,{primary:!0,onClick:this.closeModal.bind(this),children:"Close"})]})]})}}]),n}(s.a.Component)),He=Object(l.f)(Object(b.b)((function(e,t){return{jobs:e.jobs}}),(function(e){return{getJobLogs:function(t,n){return e(T.getJobLogs(t,n))},deleteJob:function(t,n){return e(T.deleteJob(t,n))}}}))(Ie)),Je=(n(241),function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).codeM=null,a.state={open:!1,codeData:"",title:"code editor"},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=N.addListener("showCodeEditor",(function(t){e.setState({open:!0,codeData:t.codeData,title:t.title||"Code editor"},(function(){e.parentCallback=t.callback}))}))}},{key:"closeModal",value:function(){this.setState({open:!1})}},{key:"saveCode",value:function(){var e=this,t=this.codeM.editor.getValue(),n=null;try{n=U.a.load(t)}catch(a){N.emit("showToasts",{type:"error",msg:a.toString()})}n&&this.setState({open:!1},(function(){e.parentCallback(t)}))}},{key:"render",value:function(){var e=this.state,t=e.open,n=e.title,a=e.codeData,s=this;return Object(f.jsxs)(Ae.a,{closeIcon:!0,open:t,centered:!1,className:"modal-codeEditor",onClose:this.closeModal.bind(this),children:[Object(f.jsx)(Ae.a.Header,{children:n}),Object(f.jsx)(Ae.a.Content,{scrolling:!0,children:Object(f.jsx)("div",{className:"codeEditor",children:Object(f.jsx)(Ce.a,{ref:function(e){(null===e||void 0===e?void 0:e.editor)&&(s.codeM=e)},value:a,options:{theme:"monokai",tabSize:2,keyMap:"sublime",mode:"yaml"}})})}),Object(f.jsxs)(Ae.a.Actions,{children:[Object(f.jsx)(y.a,{onClick:this.closeModal.bind(this),children:"Close"}),Object(f.jsx)(y.a,{primary:!0,onClick:this.saveCode.bind(this),children:"Save"})]})]})}}]),n}(s.a.Component)),Pe=n(27),Ge=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={open:!1,editType:"add",clusterName:""},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=N.addListener("showEditClusterForm",(function(t){e.setState(Object(k.a)({open:!0},t))}))}},{key:"_editCluster",value:function(){var e=this,t=this.props.addNewCluster,n=this.state.clusterName;return/[a-zA-Z][0-9a-zA-Z_-]*/.test(n)?0===n.length||n.length>50?(N.emit("showToasts",{type:"error",msg:"cluster name length error"}),!1):void t({clusterName:n},(function(t){e.setOpen(!1)})):(N.emit("showToasts",{type:"error",msg:"Cluster Name Validation Error"}),!1)}},{key:"setOpen",value:function(e){this.setState({open:e,clusterName:"",editType:"add"})}},{key:"_inputChange",value:function(e,t){this.setState(Object(Pe.a)({},e,t))}},{key:"render",value:function(){var e=this,t=this.state,n=t.open,a=t.clusterName,s=t.editType;return Object(f.jsxs)(Ae.a,{onClose:this.setOpen.bind(this,!1),open:n,size:"mini",children:[Object(f.jsx)(Ae.a.Header,{children:"add"===s?"New Cluster":"Edit Cluster"}),Object(f.jsx)(Ae.a.Content,{children:Object(f.jsx)(ee.a,{children:Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Cluster Name"}),Object(f.jsx)(ee.a.Input,{value:a,placeholder:"name",name:"clusterName",onChange:function(t,n){var a=n.name,s=n.value;e._inputChange(a,s)}})]})})}),Object(f.jsxs)(Ae.a.Actions,{children:[Object(f.jsx)(y.a,{basic:!0,onClick:this.setOpen.bind(this,!1),children:"Cancel"}),Object(f.jsx)(y.a,{primary:!0,onClick:this._editCluster.bind(this),children:"Save"})]})]})}}]),n}(s.a.Component),Ve=Object(l.f)(Object(b.b)((function(e,t){return{}}),(function(e){return{addNewCluster:function(t,n){return e(T.addNewCluster(t,n))}}}))(Ge)),Fe=n(397),Be=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={open:!1,editType:"add",pg_offline_query:null,host_ip:"",pg_role:"",pg_seq:1,clusterName:null,clusterData:null},a.roleOptions=[],a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=N.addListener("showEditClusterHostForm",(function(t){e.roleOptions=[{key:"p",text:"primary",value:"primary"},{key:"r",text:"replica",value:"replica"},{key:"o",text:"offline",value:"offline"},{key:"s",text:"standby",value:"standby"},{key:"d",text:"delayed",value:"delayed"}];var n="primary";0!=Object.keys(t.clusterData.hosts).length&&Object.keys(t.clusterData.hosts).forEach((function(e,a){var s;"primary"===(null===(s=t.clusterData.hosts[e])||void 0===s?void 0:s.pg_role)&&(n="replica")})),e.setState(Object(k.a)(Object(k.a)({open:!0},t),{},{pg_role:n}))}))}},{key:"setOpen",value:function(e){this.setState({open:e})}},{key:"_inputHandle",value:function(e,t){this.setState(Object(Pe.a)({},e,t))}},{key:"_editClusterHost",value:function(){var e=this,t=this.props,n=t.addNewClusterHost,a=t.configData,s=this.state,r=s.pg_offline_query,c=s.host_ip,i=s.pg_role,l=s.pg_seq,o=s.clusterName;if(!/^((25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))$/.test(c))return N.emit("showToasts",{type:"error",msg:"Node IP Validation Error"}),!1;if(!/^[1-9]*$/.test(l))return N.emit("showToasts",{type:"error",msg:"Instance Sequence Type Error"}),!1;var u=!1;if(Object.keys(a.all.children[o].hosts).map((function(e){a.all.children[o].hosts[e].pg_seq===l&&(u=!0)})),u)return N.emit("showToasts",{type:"error",msg:"Already the same Instance Sequence !"}),!1;var d=!1,j=!1;if(Object.keys(a.all.children[o].hosts).map((function(e){"primary"===a.all.children[o].hosts[e].pg_role&&(d=!0),e===c&&(j=!0)})),d&&"primary"===i)return N.emit("showToasts",{type:"error",msg:"Primary already exists!"}),!1;if(j)return N.emit("showToasts",{type:"error",msg:"Node IP already exists!"}),!1;var b={host_ip:c,pg_role:i,pg_seq:l,clusterName:o};null!=r&&(b.pg_offline_query=r),o&&n(b,(function(t){e.setOpen(!1)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.open,a=t.pg_offline_query,r=t.host_ip,c=t.pg_role,i=t.pg_seq,l=t.editType,o=(t.clusterData,t.clusterName);this.props.configData;return n?Object(f.jsxs)(Ae.a,{onClose:this.setOpen.bind(this,!1),open:n,size:"mini",children:[Object(f.jsx)(Ae.a.Header,{children:"add"===l?"New Instance":"Edit Instance"}),Object(f.jsx)(Ae.a.Content,{children:Object(f.jsxs)(ee.a,{children:[Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Node IP (Inventory Hostname)"}),Object(f.jsx)(te.a,{placeholder:"0.0.0.0",name:"host_ip",value:r,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"Instance Sequence"}),Object(f.jsx)(te.a,{label:o+"-",type:"number",placeholder:"1",name:"pg_seq",value:i,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,parseInt(s))}})]}),Object(f.jsx)(ee.a.Field,{children:Object(f.jsx)(ee.a.Select,{fluid:!0,label:"Role",options:this.roleOptions,name:"pg_role",placeholder:"",value:c,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})}),Object(f.jsxs)(ee.a.Group,{inline:!0,children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=a,onChange:function(t,n){n.name,n.value;e._inputHandle("pg_offline_query",null!=a&&null)}}),Object(f.jsx)("label",{children:"Offline"}),null!=a?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"pg_offline_query",checked:!0===a,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"pg_offline_query",checked:!1===a,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]})]})}),Object(f.jsxs)(Ae.a.Actions,{children:[Object(f.jsx)(y.a,{basic:!0,onClick:this.setOpen.bind(this,!1),children:"Cancel"}),Object(f.jsx)(y.a,{primary:!0,onClick:this._editClusterHost.bind(this),children:"Save"})]})]}):null}}]),n}(s.a.Component),qe=Object(l.f)(Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{addNewClusterHost:function(t,n){return e(T.addNewClusterHost(t,n))}}}))(Be)),Me=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={open:!1,editType:"add",name:"",password:"",login:null,superuser:null,createdb:null,createrole:null,inherit:null,replication:null,bypassrls:null,connlimit:"",expire_at:"",parameters:{},roles:[],expire_in:365,pgbouncer:null,comment:"",clusterData:null,parameterKey:"",parameterValue:"",displayAdvance:!1},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=N.addListener("showEditClusterPgUserForm",(function(t){e.setState(Object(k.a)({open:!0},t))}))}},{key:"setOpen",value:function(e){this.setState({open:e})}},{key:"_inputHandle",value:function(e,t){this.setState(Object(Pe.a)({},e,t))}},{key:"_addParameter",value:function(){var e=this.state,t=e.parameterKey,n=e.parameterValue;t.length>0&&n.length>0&&this.setState({parameters:Object(k.a)(Object(k.a)({},this.state.parameters),{},Object(Pe.a)({},t,n)),parameterKey:"",parameterValue:""})}},{key:"_deleteParameter",value:function(e){delete this.state.parameters[e],this.setState({parameters:Object(k.a)({},this.state.parameters)})}},{key:"_checkboxHandle",value:function(e,t,n){n?this.setState(Object(Pe.a)({},e,[].concat(Object(P.a)(this.state[e]),[t]))):(this.state[e].splice(this.state[e].findIndex((function(e){return e===t})),1),this.setState(Object(Pe.a)({},e,this.state[e])))}},{key:"_editClusterPgUser",value:function(){}},{key:"_addNewClusterPgUser",value:function(){var e=this,t=this.props,n=t.addNewClusterPgUser,a=t.configData,s=this.state,r=s.name,c=s.password,i=s.login,l=s.superuser,o=s.createdb,u=s.createrole,d=s.inherit,j=s.replication,b=s.bypassrls,h=s.connlimit,m=s.expire_at,p=s.parameters,f=s.roles,O=(s.expire_in,s.pgbouncer),v=s.comment,g=s.clusterName,x={name:r,password:c};if(!/[a-zA-Z][0-9a-zA-Z_-]*/.test(r))return N.emit("showToasts",{type:"error",msg:"Name Error"}),!1;var C=!1;if(a.all.children[g].vars.pg_users.map((function(e){e.name===r&&(C=!0)})),C)return N.emit("showToasts",{type:"error",msg:"user name already exists!"}),!1;if(m.length>0){if(!/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/.test(m))return N.emit("showToasts",{type:"error",msg:"expire_at Error"}),!1}f.length>0&&(x.roles=f),h.length>0&&(x.connlimit=h),Object.keys(p).length>0&&(x.parameters=p),m.length>0&&(x.expire_at=m),v.length>0&&(x.comment=v),null!=i&&(x.login=i),null!=l&&(x.superuser=l),null!=o&&(x.createdb=o),null!=u&&(x.createrole=u),null!=d&&(x.inherit=d),null!=j&&(x.replication=j),null!=b&&(x.bypassrls=b),null!=O&&(x.pgbouncer=O),n({formData:x,clusterName:g},(function(t){t.success&&e.setState({open:!1})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.open,a=(t.editType,t.name),r=t.password,c=t.login,i=t.superuser,l=t.createdb,o=t.createrole,u=t.inherit,d=t.replication,j=t.bypassrls,b=t.connlimit,h=t.expire_at,m=t.parameters,p=t.roles,O=(t.expire_in,t.pgbouncer),v=t.comment,g=t.parameterKey,x=t.parameterValue,C=t.displayAdvance,_=Object.keys(m).map((function(t,n){return Object(f.jsxs)(ee.a.Group,{widths:"equal",className:"m",children:[Object(f.jsx)(ee.a.Input,{value:t,placeholder:"key",disabled:!0,style:{color:"#333"}}),Object(f.jsx)(ee.a.Input,{value:m[t],placeholder:"value",disabled:!0,style:{color:"#333"}}),Object(f.jsx)(y.a,{type:"submit",icon:"minus",onClick:e._deleteParameter.bind(e,t)})]},"key"+n)}));return Object(f.jsxs)(Ae.a,{onClose:this.setOpen.bind(this,!1),open:n,size:"small",children:[Object(f.jsx)(Ae.a.Header,{children:"New User"}),Object(f.jsx)(Ae.a.Content,{children:Object(f.jsxs)(ee.a,{children:[Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"name"}),Object(f.jsx)(te.a,{placeholder:"",name:"name",value:a,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]}),Object(f.jsxs)(ee.a.Group,{widths:"equal",className:"pb-5px",children:[Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"password"}),Object(f.jsx)(te.a,{placeholder:"",name:"password",value:r,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"comment"}),Object(f.jsx)(te.a,{placeholder:"example personal user for interactive queries",name:"comment",value:v,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]})]}),Object(f.jsx)(I.a,{horizontal:!0,children:Object(f.jsx)(L.a,{onClick:function(){e.setState({displayAdvance:!C})},size:"large",as:"a",content:"Advance Setting",icon:"caret down"})}),C?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsxs)(ee.a.Group,{widths:"equal",className:"border-bottom plr-05rem pb-5px",children:[Object(f.jsxs)(ee.a.Group,{inline:!0,className:"flex-1",children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=c,onChange:function(t,n){n.name,n.value;e._inputHandle("login",null==c||null)}}),Object(f.jsx)("label",{children:"login"}),null!=c?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"login",checked:!0===c,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"login",checked:!1===c,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]}),Object(f.jsxs)(ee.a.Group,{inline:!0,className:"flex-1",children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=i,onChange:function(t,n){n.name,n.value;e._inputHandle("superuser",null==i||null)}}),Object(f.jsx)("label",{children:"superuser"}),null!=i?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"superuser",checked:!0===i,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"superuser",checked:!1===i,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]})]}),Object(f.jsxs)(ee.a.Group,{widths:"equal",className:"border-bottom plr-05rem pb-5px",children:[Object(f.jsxs)(ee.a.Group,{inline:!0,className:"flex-1",children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=l,onChange:function(t,n){n.name,n.value;e._inputHandle("createdb",null==l||null)}}),Object(f.jsx)("label",{children:"createdb"}),null!=l?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"createdb",checked:!0===l,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"createdb",checked:!1===l,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]}),Object(f.jsxs)(ee.a.Group,{inline:!0,className:"flex-1",children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=o,onChange:function(t,n){n.name,n.value;e._inputHandle("createrole",null==o||null)}}),Object(f.jsx)("label",{children:"createrole"}),null!=o?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"createrole",checked:!0===o,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"createrole",checked:!1===o,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]})]}),Object(f.jsxs)(ee.a.Group,{widths:"equal",className:"border-bottom plr-05rem pb-5px",children:[Object(f.jsxs)(ee.a.Group,{inline:!0,className:"flex-1",children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=u,onChange:function(t,n){n.name,n.value;e._inputHandle("inherit",null==u||null)}}),Object(f.jsx)("label",{children:"inherit"}),null!=u?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"inherit",checked:!0===u,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"inherit",checked:!1===u,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]}),Object(f.jsxs)(ee.a.Group,{inline:!0,className:"flex-1",children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=d,onChange:function(t,n){n.name,n.value;e._inputHandle("replication",null==d||null)}}),Object(f.jsx)("label",{children:"replication"}),null!=d?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"replication",checked:!0===d,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"replication",checked:!1===d,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]})]}),Object(f.jsxs)(ee.a.Group,{widths:"equal",className:"border-bottom plr-05rem pb-5px",children:[Object(f.jsxs)(ee.a.Group,{inline:!0,className:"flex-1",children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=j,onChange:function(t,n){n.name,n.value;e._inputHandle("bypassrls",null==j||null)}}),Object(f.jsx)("label",{children:"bypassrls"}),null!=j?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"bypassrls",checked:!0===j,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"bypassrls",checked:!1===j,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]}),Object(f.jsxs)(ee.a.Group,{inline:!0,className:"flex-1",children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=O,onChange:function(t,n){n.name,n.value;e._inputHandle("pgbouncer",null==O||null)}}),Object(f.jsx)("label",{children:"pgbouncer"}),null!=O?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"pgbouncer",checked:!0===O,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"pgbouncer",checked:!1===O,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]})]}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"roles (Separated by commas)"}),Object(f.jsx)(te.a,{placeholder:"role,role",name:"roles",value:p.join(","),onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s.split(","))}})]}),Object(f.jsxs)(ee.a.Group,{widths:"equal",children:[Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"connlimit"}),Object(f.jsx)(te.a,{placeholder:"-1",name:"connlimit",value:b,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"expire_at"}),Object(f.jsx)(te.a,{placeholder:"YYYY-MM-DD",name:"expire_at",value:h,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]})]}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"parameters"}),Object(f.jsxs)(ee.a.Group,{widths:"equal",children:[Object(f.jsx)(ee.a.Input,{name:"parameterKey",value:g,placeholder:"key",onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}}),Object(f.jsx)(ee.a.Input,{name:"parameterValue",value:x,placeholder:"value",onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}}),Object(f.jsx)(y.a,{type:"submit",icon:"plus",onClick:this._addParameter.bind(this)})]}),Object(f.jsx)("div",{children:_})]})]}):null]})}),Object(f.jsxs)(Ae.a.Actions,{children:[Object(f.jsx)(y.a,{onClick:this.setOpen.bind(this,!1),children:"Cancel"}),Object(f.jsx)(y.a,{primary:!0,onClick:this._addNewClusterPgUser.bind(this),children:"Save"})]})]})}}]),n}(s.a.Component),ze=Object(l.f)(Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{addNewClusterPgUser:function(t,n){return e(T.addNewClusterPgUser(t,n))}}}))(Me)),We=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={open:!1,editType:"add",name:"",owner:"",schemas:[],extensions:[],parameters:{},comment:"",pgbouncer:null,allowconn:null,revokeconn:null,clusterName:null,parameterKey:"",parameterValue:"",extensionKey:"",extensionValue:"",displayAdvance:!1},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=N.addListener("showEditClusterPgDatabaseForm",(function(t){e.setState(Object(k.a)({open:!0},t))}))}},{key:"setOpen",value:function(e){this.setState({open:e})}},{key:"_inputHandle",value:function(e,t){this.setState(Object(Pe.a)({},e,t))}},{key:"_addNewClusterPgDatabase",value:function(){var e=this,t=this.props,n=t.addNewClusterPgDatabase,a=t.configData,s=this.state,r=s.name,c=s.owner,i=s.schemas,l=s.extensions,o=s.parameters,u=s.comment,d=s.pgbouncer,j=s.allowconn,b=s.revokeconn,h=s.clusterName;if(!/[a-zA-Z][0-9a-zA-Z_-]*/.test(r))return N.emit("showToasts",{type:"error",msg:"Name Error"}),!1;var m=!1;if(a.all.children[h].vars.pg_databases.map((function(e){e.name===r&&(m=!0)})),m)return N.emit("showToasts",{type:"error",msg:"database name already exists!"}),!1;var p={name:r};u.length>0&&(p.comment=u),l.length>0&&(p.extensions=l),c.length>0&&(p.owner=c),i.length>0&&(p.schemas=i),Object.keys(o).length>0&&(p.parameters=o),null!=d&&(p.pgbouncer=d),null!=j&&(p.allowconn=j),null!=b&&(p.revokeconn=b),h&&n({formData:p,clusterName:h},(function(t){t.success&&e.setState({open:!1})}))}},{key:"_addParameter",value:function(){var e=this.state,t=e.parameterKey,n=e.parameterValue;t.length>0&&n.length>0&&this.setState({parameters:Object(k.a)(Object(k.a)({},this.state.parameters),{},Object(Pe.a)({},t,n)),parameterKey:"",parameterValue:""})}},{key:"_deleteParameter",value:function(e){delete this.state.parameters[e],this.setState({parameters:Object(k.a)({},this.state.parameters)})}},{key:"_addExtension",value:function(){var e=this.state,t=e.extensionKey,n=e.extensionValue;if(t.length>0){var a={name:t};n.length>0&&(a.schema=n),this.setState({extensions:[].concat(Object(P.a)(this.state.extensions),[a]),extensionKey:"",extensionValue:""})}}},{key:"_deleteExtension",value:function(e){var t=this.state.extensions.filter((function(t,n){return JSON.stringify(t)!=JSON.stringify(e)}));this.setState({extensions:t})}},{key:"render",value:function(){var e=this,t=this.state,n=t.open,a=t.name,r=t.owner,c=t.parameters,i=t.schemas,l=t.extensions,o=t.comment,u=t.pgbouncer,d=t.allowconn,j=t.revokeconn,b=t.editType,h=t.parameterKey,m=t.parameterValue,p=t.extensionKey,O=t.extensionValue,v=t.displayAdvance,g=Object.keys(c).map((function(t,n){return Object(f.jsxs)(ee.a.Group,{widths:"equal",className:"m",children:[Object(f.jsx)(ee.a.Input,{value:t,placeholder:"key",disabled:!0,style:{color:"#333"}}),Object(f.jsx)(ee.a.Input,{value:c[t],placeholder:"value",disabled:!0,style:{color:"#333"}}),Object(f.jsx)(y.a,{type:"submit",icon:"minus",onClick:e._deleteParameter.bind(e,t)})]},"key-"+n)})),x=l.map((function(t,n){return Object(f.jsxs)(ee.a.Group,{widths:"equal",className:"m",children:[Object(f.jsx)(te.a,{value:t.name,placeholder:"name",disabled:!0,label:"name",style:{color:"#333"},className:"field"}),t.schema?Object(f.jsx)(te.a,{value:t.schema,placeholder:"schema",disabled:!0,label:"schema",style:{color:"#333"},className:"field"}):null,Object(f.jsx)(y.a,{type:"submit",icon:"minus",onClick:e._deleteExtension.bind(e,t)})]},"key-"+n)}));return Object(f.jsxs)(Ae.a,{onClose:this.setOpen.bind(this,!1),open:n,size:"small",children:[Object(f.jsx)(Ae.a.Header,{children:"add"===b?"New Database":"Edit Database"}),Object(f.jsx)(Ae.a.Content,{children:Object(f.jsxs)(ee.a,{children:[Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"name"}),Object(f.jsx)(te.a,{placeholder:"",name:"name",value:a,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]}),Object(f.jsx)(I.a,{horizontal:!0,children:Object(f.jsx)(L.a,{onClick:function(){e.setState({displayAdvance:!v})},size:"large",as:"a",content:"Advance Setting",icon:"caret down"})}),v?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsxs)(ee.a.Group,{widths:"equal",className:"pb-5px",children:[Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"owner"}),Object(f.jsx)(te.a,{placeholder:"",name:"owner",value:r,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"comment"}),Object(f.jsx)(te.a,{placeholder:"",name:"comment",value:o,onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}})]})]}),Object(f.jsxs)(ee.a.Group,{widths:"equal",className:"border-bottom plr-05rem pb-5px",children:[Object(f.jsxs)(ee.a.Group,{inline:!0,className:"flex-1",children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=u,onChange:function(t,n){n.name,n.value;e._inputHandle("pgbouncer",null==u||null)}}),Object(f.jsx)("label",{children:"pgbouncer"}),null!=u?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"pgbouncer",checked:!0===u,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"pgbouncer",checked:!1===u,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]}),Object(f.jsxs)(ee.a.Group,{inline:!0,className:"flex-1",children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=d,onChange:function(t,n){n.name,n.value;e._inputHandle("allowconn",null==d||null)}}),Object(f.jsx)("label",{children:"allowconn"}),null!=d?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"allowconn",checked:!0===d,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"allowconn",checked:!1===d,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]})]}),Object(f.jsx)(ee.a.Group,{widths:"equal",className:"border-bottom plr-05rem pb-5px",children:Object(f.jsxs)(ee.a.Group,{inline:!0,className:"flex-1",children:[Object(f.jsx)(Fe.a,{className:"mr-1rem",checked:null!=j,onChange:function(t,n){n.name,n.value;e._inputHandle("revokeconn",null==j||null)}}),Object(f.jsx)("label",{children:"revokeconn"}),null!=j?Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)(ee.a.Radio,{label:"true",name:"revokeconn",checked:!0===j,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!0)}}),Object(f.jsx)(ee.a.Radio,{label:"false",name:"revokeconn",checked:!1===j,onChange:function(t,n){var a=n.name;n.value;e._inputHandle(a,!1)}})]}):null]})}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"schemas (Separated by commas)"}),Object(f.jsx)(te.a,{placeholder:"schema,schema",name:"schemas",value:i.join(","),onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s.split(","))}})]}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"parameters"}),Object(f.jsxs)(ee.a.Group,{widths:"equal",children:[Object(f.jsx)(ee.a.Input,{name:"parameterKey",value:h,placeholder:"key",onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}}),Object(f.jsx)(ee.a.Input,{name:"parameterValue",value:m,placeholder:"value",onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}}),Object(f.jsx)(y.a,{type:"submit",icon:"plus",onClick:this._addParameter.bind(this)})]}),Object(f.jsx)("div",{children:g})]}),Object(f.jsxs)(ee.a.Field,{children:[Object(f.jsx)("label",{children:"extensions"}),Object(f.jsxs)(ee.a.Group,{widths:"equal",children:[Object(f.jsx)(ee.a.Input,{name:"extensionKey",value:p,placeholder:"name",onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}}),Object(f.jsx)(ee.a.Input,{name:"extensionValue",value:O,placeholder:"schema",onChange:function(t,n){var a=n.name,s=n.value;e._inputHandle(a,s)}}),Object(f.jsx)(y.a,{type:"submit",icon:"plus",onClick:this._addExtension.bind(this)})]}),Object(f.jsx)("div",{children:x})]})]}):null]})}),Object(f.jsxs)(Ae.a.Actions,{children:[Object(f.jsx)(y.a,{basic:!0,onClick:this.setOpen.bind(this,!1),children:"Cancel"}),Object(f.jsx)(y.a,{primary:!0,onClick:this._addNewClusterPgDatabase.bind(this),children:"Save"})]})]})}}]),n}(s.a.Component),Ke=Object(l.f)(Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{addNewClusterPgDatabase:function(t,n){return e(T.addNewClusterPgDatabase(t,n))}}}))(We)),Ye=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsxs)("div",{className:"inner-page",children:[Object(f.jsx)(v,{}),Object(f.jsx)("div",{id:"mainWrap",children:Object(f.jsxs)("div",{id:"mainContent",children:[Object(f.jsx)(l.a,{path:"/",exact:!0,component:$}),Object(f.jsx)(l.a,{path:"/config",component:ke}),Object(f.jsx)(l.a,{path:"/playbook",component:xe}),Object(f.jsx)(l.a,{path:"/jobs",component:Le})]})}),Object(f.jsx)(C,{})]}),Object(f.jsx)(He,{}),Object(f.jsx)(Je,{}),Object(f.jsx)(Ve,{}),Object(f.jsx)(qe,{}),Object(f.jsx)(ze,{}),Object(f.jsx)(Ke,{})]})}}]),n}(s.a.Component),Ze=n(185),$e=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={visible:!!e.visible&&e.visible,loadingText:e.loadingText?e.loadingText:""},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=N.addListener("showLoadingCover",(function(t){e.setState({visible:t,loadingText:"\u6570\u636e\u52a0\u8f7d\u4e2d..."})}))}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.visible,n=e.loadingText;return t?Object(f.jsx)("div",{id:"loadingCover",children:Object(f.jsxs)("div",{className:"loading-overlay",children:[Object(f.jsx)("div",{className:"loading loading-lg"}),Object(f.jsx)("div",{className:"font-bold",style:{marginLeft:"2rem"},children:n})]})}):null}}]),n}(s.a.Component),Qe=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"_getConfigData",value:function(){(0,this.props.getConfigData)({},(function(e){}))}},{key:"render",value:function(){var e=this.props,t=e.component,n=e.configData,a=Object(Ze.a)(e,["component","configData"]);return n.hasOwnProperty("all")?Object(f.jsx)(l.a,Object(k.a)(Object(k.a)({},a),{},{render:function(e){return Object(f.jsx)(t,Object(k.a)({},e))}})):(this._getConfigData(),Object(f.jsx)($e,{visible:!0,loadingText:"initializing..."}))}}]),n}(s.a.Component),Xe=Object(b.b)((function(e,t){return{configData:e.configData}}),(function(e){return{getConfigData:function(t,n){return e(T.getConfigData(t,n))}}}))(Qe);n(242);var et=function(){return Object(f.jsx)(i.a,{basename:"/",children:Object(f.jsx)(l.c,{children:Object(f.jsx)(Xe,{path:"/",component:Ye})})})},tt=function(e){e&&e instanceof Function&&n.e(124).then(n.bind(null,401)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),s(e),r(e),c(e)}))},nt=n(75),at=n(182),st={};var rt={};var ct={list:[],logs:{}};var it=Object(nt.c)({account:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st;return e},configData:function(){var e,t,n,a,s,r,c,i,l,o,u,d,j,b,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt,m=arguments.length>1?arguments[1]:void 0;switch(m.type){case D.GET_CONFIG_DATA_SUCCESS:case D.SAVE_LOCAL_CONFIG_DATA_SUCCESS:return m.data;case D.ADD_NEW_CLUSTER_SUCCESS:return h.all.children[m.clusterName]={edit:!0,hosts:{},vars:{pg_cluster:m.clusterName,pg_users:[],pg_databases:[]}},JSON.parse(JSON.stringify(h));case D.REMOVE_CLUSTER_SUCCESS:return delete h.all.children[m.clusterName],JSON.parse(JSON.stringify(h));case D.ADD_NEW_CLUSTER_HOST_SUCCESS:return h.all.children[m.clusterName].edit=!0,h.all.children[m.clusterName].hosts[m.host_ip]={pg_offline_query:m.pg_offline_query,pg_role:m.pg_role,pg_seq:m.pg_seq},JSON.parse(JSON.stringify(h));case D.REMOVE_CLUSTER_HOST_SUCCESS:return h.all.children[m.clusterName].edit=!0,delete h.all.children[m.clusterName].hosts[m.hostName],JSON.parse(JSON.stringify(h));case D.ADD_NEW_CLUSTER_PG_USER_SUCCESS:if((null===(e=h.all.children[m.clusterName])||void 0===e?void 0:e.vars)||(h.all.children[m.clusterName].vars={}),(null===(t=h.all.children[m.clusterName])||void 0===t||null===(n=t.vars)||void 0===n?void 0:n.pg_users)||(h.all.children[m.clusterName].vars.pg_users=[]),null===(a=h.all.children[m.clusterName])||void 0===a||null===(s=a.vars)||void 0===s?void 0:s.pg_users){var p=m.formData;h.all.children[m.clusterName].vars.pg_users.push(p),h.all.children[m.clusterName].edit=!0}return JSON.parse(JSON.stringify(h));case D.REMOVE_CLUSTER_PG_USER_SUCCESS:if(null===(r=h.all.children[m.clusterName])||void 0===r||null===(c=r.vars)||void 0===c?void 0:c.pg_users){var f=h.all.children[m.clusterName].vars.pg_users.findIndex((function(e){return e.name===m.name}));h.all.children[m.clusterName].vars.pg_users.splice(f,1),h.all.children[m.clusterName].edit=!0}return JSON.parse(JSON.stringify(h));case D.ADD_NEW_CLUSTER_PG_DATABASE_SUCCESS:if((null===(i=h.all.children[m.clusterName])||void 0===i?void 0:i.vars)||(h.all.children[m.clusterName].vars={}),(null===(l=h.all.children[m.clusterName])||void 0===l||null===(o=l.vars)||void 0===o?void 0:o.pg_databases)||(h.all.children[m.clusterName].vars.pg_databases=[]),null===(u=h.all.children[m.clusterName])||void 0===u||null===(d=u.vars)||void 0===d?void 0:d.pg_databases){var O=m.formData;h.all.children[m.clusterName].vars.pg_databases.push(O),h.all.children[m.clusterName].edit=!0}return JSON.parse(JSON.stringify(h));case D.REMOVE_CLUSTER_PG_DATABASE_SUCCESS:if(null===(j=h.all.children[m.clusterName])||void 0===j||null===(b=j.vars)||void 0===b?void 0:b.pg_databases){var v=h.all.children[m.clusterName].vars.pg_databases.findIndex((function(e){return e.name===m.name}));h.all.children[m.clusterName].vars.pg_databases.splice(v,1),h.all.children[m.clusterName].edit=!0}return JSON.parse(JSON.stringify(h));case D.SAVE_LOCAL_CLUSTER_VARS_CONFIG_SUCCESS:return h.all.children[m.clusterName].vars=m.configData,h.all.children[m.clusterName].edit=!0,JSON.parse(JSON.stringify(h));case D.SAVE_LOCAL_CLUSTER_CONFIG_SUCCESS:return h.all.children[m.clusterName]=m.configData,h.all.children[m.clusterName].edit=!0,JSON.parse(JSON.stringify(h));default:return h}},jobs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D.GET_JOBS_SUCCESS:return Object(k.a)(Object(k.a)({},e),{},{list:t.data});case D.DELETE_JOB_SUCCESS:return e;case D.CREATE_JOB_SUCCESS:return Object(k.a)(Object(k.a)({},e),{},{list:[t.data].concat(Object(P.a)(e.list))});case D.GET_JOB_LOGS_SUCCESS:return Object(k.a)(Object(k.a)({},e),{},{logs:Object(k.a)(Object(k.a)({},e.logs),{},Object(Pe.a)({},t.id,t.data))});default:return e}}}),lt=[function(e){return function(e){return function(t){return e(t)}}},at.a],ot=nt.a.apply(void 0,lt)(nt.d)(it,{}),ut=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={toasts:[]},a}return Object(u.a)(n,[{key:"_delItem",value:function(){var e=this.state.toasts;e.shift(),this.setState({toasts:e})}},{key:"componentDidMount",value:function(){var e=this;this.emitter=N.addListener("showToasts",(function(t){e.setState({toasts:[].concat(Object(P.a)(e.state.toasts),[t])},(function(){setTimeout((function(){e._delItem()}),3e3)}))}))}},{key:"componentWillUnmount",value:function(){}},{key:"_renderToast",value:function(e,t){return Object(a.createElement)(F.a,Object(k.a)(Object(k.a)({className:"toast"},Object(Pe.a)({},e.type,e.type)),{},{key:t,header:e.msg}))}},{key:"render",value:function(){var e=this,t=this.state.toasts,n=[];return t.forEach((function(t,a){n.push(e._renderToast(t,a))})),Object(f.jsx)("div",{id:"toastsPanel",children:n})}}]),n}(s.a.Component),dt=n(387),jt=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={open:!1,content:"",confirmButton:"OK",cancelButton:"Cancel"},a.parentCallback=null,a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.emitter=N.addListener("showConfirmBox",(function(t){e.setState(Object(k.a)(Object(k.a)({},t),{},{open:!0})),e.parentCallback=t.callback}))}},{key:"handleConfirm",value:function(){var e=this;this.setState({content:"Are you sure?",confirmButton:"OK",cancelButton:"Cancel",open:!1},(function(){"function"===typeof e.parentCallback&&e.parentCallback(!0)}))}},{key:"handleCancel",value:function(){var e=this;this.setState({content:"Are you sure?",confirmButton:"OK",cancelButton:"Cancel",open:!1},(function(){"function"===typeof e.parentCallback&&e.parentCallback(!1)}))}},{key:"render",value:function(){var e=this.state,t=e.open,n=e.content,a=e.confirmButton,s=e.cancelButton;return Object(f.jsx)(dt.a,{size:"mini",open:t,content:n,confirmButton:a,cancelButton:s,onCancel:this.handleCancel.bind(this),onConfirm:this.handleConfirm.bind(this)})}}]),n}(s.a.Component);n(245);c.a.render(Object(f.jsx)(b.a,{store:ot,children:Object(f.jsxs)(s.a.Fragment,{children:[Object(f.jsx)($e,{}),Object(f.jsx)(ut,{}),Object(f.jsx)(jt,{}),Object(f.jsx)(et,{})]})}),document.getElementById("root")),tt()},52:function(e,t,n){}},[[246,7,8]]]);